[
    {
  "question": "지난 달 총 재고 중량과 금액을 표시하세요.",
  "answer": "지난 달 총 재고 중량은 {{df['total_weight'].sum()}}kg이며, 총 금액은 {{df['total_amount'].sum()}}원입니다.",
  "stats": "total_weight | total_amount\n ---------------------------\n 1167751531.062 | 4653142699697.0"
  },
  {
  "question": "지난 달 공장별 재고 중량과 금액을 재고 금액이 큰 순으로 표시하세요.",
  "answer": "지난 달 재고 금액이 가장 큰 공장의 이름은 {{df.sort_values('total_amount', ascending=False).iloc[0]['factory_name']}}이며, 재고 중량은 {{df.sort_values('total_amount', ascending=False).iloc[0]['total_weight']}}kg, 금액은 {{df.sort_values('total_amount', ascending=False).iloc[0]['total_amount']}}원입니다. 공장별 재고 중량과 금액을 재고 금액이 큰 순으로 정렬한 표는 다음과 같습니다.",
  "stats": "factory_name | total_weight | total_amount\n ------------------------------------------\n 가공 | 171597257.0 | 1001920178440\n 2제강 | 290347309.0 | 534161998338\n 소경 | 50686286.0 | 491415317400\n 2단조 | 119770167.0 | 484395495537\n 소형정정 | 128900598.43500002 | 411381087073\n ... (중간 생략) ...\n 대형정정 | 12959030.0 | 58038454760\n 1단조 | 3405308.0 | 35250258294\n RFM | 1928327.0 | 10372153615\n 기타 | 90774.0 | 696943840\n | 87332.0 | 220661623"
  },
  {
  "question": "지난 달 공장 실 구분별 재고 중량과 금액을 재고 금액이 큰 순으로 표시하세요.",
  "answer": "지난 달 재고 금액이 가장 큰 공장 실 구분은 {{df.sort_values('total_amount', ascending=False).iloc[0]['factory_division']}}이며, 재고 중량은 {{df.sort_values('total_amount', ascending=False).iloc[0]['total_weight']}}kg, 금액은 {{df.sort_values('total_amount', ascending=False).iloc[0]['total_amount']}}원입니다. 공장 실 구분별 재고 중량과 금액을 재고 금액이 큰 순으로 정렬한 표는 다음과 같습니다. 지난 달 총 자재 중량은 {{df['total_weight'].sum()}}kg이며, 총 금액은 {{df['total_amount'].sum()}} 원입니다.",
  "stats": "factory_division | total_weight | total_amount \n---------------------------------------------- \n소형생산실 | 824323065.4350001 | 2614854358103 \n대형생산실 | 247386524.0 | 1292937446762 \n강관생산실 | 60136459.0 | 578455450743 \n기타 | 35905482.627000004 | 166895444089"
  },
  {
  "question": "지난 달 수요가별 재고 중량과 금액을 재고 중량이 큰 순으로 표시하세요.",
  "answer": "지난 달 수요가별 재고 중량이 가장 큰 고객은 {{df.sort_values('total_weight', ascending=False).iloc[0]['customer_name']}}이며, 재고 중량은 {{df.sort_values('total_weight', ascending=False).iloc[0]['total_weight']}}kg, 금액은 {{df.sort_values('total_weight', ascending=False).iloc[0]['total_amount']}}원입니다. 수요가별 재고 중량과 금액을 재고 중량이 큰 순으로 정렬한 표는 다음과 같습니다.",
  "stats": "customer_name | total_weight | total_amount\n -------------------------------------------\n | 143027092.627 | 400681465255\n (주)세아특수강 | 42318577.0 | 72263376784\n 주식회사 티플랙스 | 31155321.0 | 150054334470\n 용진스테코 | 28817596.0 | 114895222122\n 동일산업(주) | 28631588.0 | 29782384276\n ... (중간 생략) ...\n EUREINOX | 0.0 | 0\n KEI INDUSTRIES | 0.0 | 0\n TENGYUAN WIRE (VIETNAM) COMPANY LIMITED | 0.0 | 0\n 주식회사 TNP | 0.0 | 0\n TSUKIMORI KOGYO CO., LTD. | 0.0 | 0"
  },
  {
  "question": "최근 3개월의 총 재고 중량과 금액을 월별로 표시하세요.",
  "answer": "최근 3개월 동안의 월별 총 재고 중량과 금액은 다음과 같습니다.",
  "stats": "year_month | factory_name | total_weight | total_amount\n -------------------------------------------------------\n 2025-02 | 1단조 | 215782.0 | 2315306053\n 2025-02 | 2단조 | 8181325.0 | 34427889409\n 2025-02 | 2제강 | 16608189.0 | 30841845718\n 2025-02 | 3제강 | 3269375.0 | 13520556785\n 2025-02 | RFM | 248602.0 | 998981992\n ... (중간 생략) ...\n 2025-02 | 산세 | 5080094.0 | 22740813390\n 2025-02 | 소경 | 3322003.0 | 33373107753\n 2025-02 | 소형압연 | 10004101.0 | 22235925862\n 2025-02 | 소형정정 | 10086822.521 | 31431970665\n 2025-02 | 특수제강 | 870415.0 | 13977555549"
  },
  {
  "question": "최근 3개월 공장별 재고 중량과 금액을 월별로 표시하세요.",
  "answer": "최근 3개월 동안 각 공장의 월별 총 재고 중량과 금액은 통계 테이블에 정리되어 있습니다. 각 공장의 월별 재고 중량과 금액을 확인하려면 테이블의 'total_weight'와 'total_amount' 열을 참조하세요.",
  "stats": "year_month | factory_name | total_weight | total_amount\n -------------------------------------------------------\n 2025-02 | 1단조 | 215782.0 | 2315306053\n 2025-02 | 2단조 | 8181325.0 | 34427889409\n 2025-02 | 2제강 | 16608189.0 | 30841845718\n 2025-02 | 3제강 | 3269375.0 | 13520556785\n 2025-02 | RFM | 248602.0 | 998981992\n ... (중간 생략) ...\n 2025-02 | 산세 | 5080094.0 | 22740813390\n 2025-02 | 소경 | 3322003.0 | 33373107753\n 2025-02 | 소형압연 | 10004101.0 | 22235925862\n 2025-02 | 소형정정 | 10086822.521 | 31431970665\n 2025-02 | 특수제강 | 870415.0 | 13977555549"
  },
  {
  "question": "최근 3개월 공장의 실별 재고 중량과 금액을 월별로 표시하세요.",
  "answer": "최근 3개월 동안 각 공장 실별로 집계된 재고 중량과 금액을 월별로 확인할 수 있습니다. 각 공장 실의 재고 중량과 금액은 통계 테이블에서 확인하실 수 있습니다.",
  "stats": "year_month | factory_department | total_weight | total_amount\n -------------------------------------------------------------\n 2025-02 | 1단조 | 215782.0 | 2315306053\n 2025-02 | 2단조 | 8181325.0 | 34427889409\n 2025-02 | 2제강 | 16608189.0 | 30841845718\n 2025-02 | 3제강 | 3269375.0 | 13520556785\n 2025-02 | RFM | 248602.0 | 998981992\n ... (중간 생략) ...\n 2025-02 | 산세 | 5080094.0 | 22740813390\n 2025-02 | 소경 | 3322003.0 | 33373107753\n 2025-02 | 소형압연 | 10004101.0 | 22235925862\n 2025-02 | 소형정정 | 10086822.521 | 31431970665\n 2025-02 | 특수제강 | 870415.0 | 13977555549"
  },
  {
  "question": "최근 3개월 제소구분별 재고 중량과 금액을 월별로 표시하세요.",
  "answer": "최근 3개월 동안 제품 카테고리별 총 재고 중량은 {{df.groupby('item_category')['total_weight'].sum()}}kg이며, 총 금액은 {{df.groupby('item_category')['total_amount'].sum()}}원입니다. 제품 카테고리별 재고 중량과 금액을 월별로 표시한 표는 다음과 같습니다.",
  "stats": "year_month | product_category | major_steel_type | total_weight | total_amount\n ------------------------------------------------------------------------------\n 2025-02 | 소재성 재공 | STS | 13980319.0 | 51905757801\n 2025-02 | 소재성 재공 | 공구강 | 2153499.0 | 6252918275\n 2025-02 | 소재성 재공 | 탄합강 | 9430143.183 | 12223469064\n 2025-02 | 소재성 재공 | 특수합금 | 979683.0 | 23558895661\n 2025-02 | 완제품 재고 | STS | 11640320.0 | 63758019974\n ... (중간 생략) ...\n 2025-02 | 완제품 재고 | 특수합금 | 283756.0 | 10688891354\n 2025-02 | 제품성 재공 | STS | 11618739.0 | 58522717334\n 2025-02 | 제품성 재공 | 공구강 | 5906088.0 | 20262048883\n 2025-02 | 제품성 재공 | 탄합강 | 2914219.965 | 9106009886\n 2025-02 | 제품성 재공 | 특수합금 | 604727.0 | 18012168839"
  },
  {
  "question": "최근 3개월 주여구분별 재고 중량과 금액을 월별로 표시하세요.",
  "answer": "최근 3개월 동안의 주문 유형별 총 재고 중량은 {{df['total_weight'].sum()}}kg이며, 총 금액은 {{df['total_amount'].sum()}}원입니다. 주문 유형별 재고 중량과 금액을 월별로 표시한 표는 다음과 같습니다.",
  "stats": "year_month | product_category | major_steel_type | total_weight | total_amount\n ------------------------------------------------------------------------------\n 2025-02 | 소재성 재공 | STS | 13980319.0 | 51905757801\n 2025-02 | 소재성 재공 | 공구강 | 2153499.0 | 6252918275\n 2025-02 | 소재성 재공 | 탄합강 | 9430143.183 | 12223469064\n 2025-02 | 소재성 재공 | 특수합금 | 979683.0 | 23558895661\n 2025-02 | 완제품 재고 | STS | 11640320.0 | 63758019974\n ... (중간 생략) ...\n 2025-02 | 완제품 재고 | 특수합금 | 283756.0 | 10688891354\n 2025-02 | 제품성 재공 | STS | 11618739.0 | 58522717334\n 2025-02 | 제품성 재공 | 공구강 | 5906088.0 | 20262048883\n 2025-02 | 제품성 재공 | 탄합강 | 2914219.965 | 9106009886\n 2025-02 | 제품성 재공 | 특수합금 | 604727.0 | 18012168839"
  },
  {
  "question": "최근 3개월 제소구분별, 대강종별 재고 중량과 금액을 월별로 표시하세요.",
  "answer": "최근 3개월 동안, 제소구분별, 대강종별 재고 중량과 금액을 월별로 분석한 결과, 가장 많은 재고 중량을 가진 제소구분은 {{df.sort_values('total_weight', ascending=False).iloc[0]['item_category']}}이며, 해당 중량은 {{df.sort_values('total_weight', ascending=False).iloc[0]['total_weight']}}kg입니다. 또한, 가장 많은 재고 금액을 가진 제소구분은 {{df.sort_values('total_amount', ascending=False).iloc[0]['item_category']}}이며, 해당 금액은 {{df.sort_values('total_amount', ascending=False).iloc[0]['total_amount']}}원입니다. 이 기간 동안의 총 재고 중량은 {{df['total_weight'].sum()}}kg이며, 총 재고 금액은 {{df['total_amount'].sum()}}원입니다.",
  "stats": "sales_team | total_weight\n -------------------------\n 탄합영업실 | 22044580.0\n 봉강내수영업팀 | 6959667.0\n 공구강내수영업팀 | 4493050.0\n 선재내수영업팀 | 3554580.0\n STS수출영업팀 | 2273796.0\n ... (중간 생략) ...\n 압연설비 | 2011.0\n 실수요영업1팀 | 1696.0\n 스틸공정연구그룹 | 1602.0\n 특수합금파트 | 646.0\n 강관생산관리팀 | 335.0"
  },
  {
  "question": "최근 3개월 주여구분별, 대강종별 재고 중량과 금액을 월별로 표시하세요.",
  "answer": "최근 3개월 동안 주문 유형별, 주요 강종별 재고 중량과 금액을 월별로 나타낸 결과는 다음과 같습니다. 가장 많은 재고 중량을 가진 주문 유형은 {{df.sort_values('total_weight', ascending=False).iloc[0]['ORDER_type']}}이며, 해당 중량은 {{df.sort_values('total_weight', ascending=False).iloc[0]['total_weight']}}kg입니다. 가장 많은 재고 금액을 가진 주문 유형은 {{df.sort_values('total_amount', ascending=False).iloc[0]['ORDER_type']}}이며, 해당 금액은 {{df.sort_values('total_amount', ascending=False).iloc[0]['total_amount']}}원입니다. 이 기간 동안 총 재고 중량은 {{df['total_weight'].sum()}}kg이며, 총 재고 금액은 {{df['total_amount'].sum()}}원입니다.",
  "stats": "year_month | order_type | major_steel_type | total_weight | total_amount\n ------------------------------------------------------------------------\n 2024-12 | | STS | 3197.0 | 17310018\n 2024-12 | | 공구강 | 5122.0 | 15824501\n 2024-12 | | 탄합강 | 14005.627 | 15014968\n 2024-12 | 여재 | STS | 3867222.0 | 14248618233\n 2024-12 | 여재 | 공구강 | 141208.0 | 506830367\n ... (중간 생략) ...\n 2025-02 | 여재 | 특수합금 | 222289.0 | 5016404437\n 2025-02 | 주문재 | STS | 31239106.0 | 152902823404\n 2025-02 | 주문재 | 공구강 | 15357074.0 | 58088442485\n 2025-02 | 주문재 | 탄합강 | 24036019.521 | 40874741561\n 2025-02 | 주문재 | 특수합금 | 1645877.0 | 47243551417"
  },
  {
  "question": "24년 9월 기준으로 팀별 제품 재고 중량을 중량이 큰 순으로 나열하세요.",
  "answer": "2024년 9월 기준으로 제품 재고 중량이 가장 큰 팀은 {{df.sort_values('total_weight', ascending=False).iloc[0]['sales_team']}}이며, 해당 팀의 제품 재고 중량은 {{df.sort_values('total_weight', ascending=False).iloc[0]['total_weight']}}kg입니다. 팀별 제품 재고 중량을 중량이 큰 순으로 나열한 표는 다음과 같습니다.",
  "stats": "year_month | team_division | total_weight | total_amount\n --------------------------------------------------------\n 2024-09 | 기술연구소 | 1602.0 | 15475320\n 2024-09 | 기타 | 815472.0 | 6895156065\n 2024-09 | 영업부문 | 32976305.0 | 122695320011"
  },
  {
  "question": "제품 재고 기준으로 팀별로 구분하여 3개월치에 대한 추이를 보여주세요.",
  "answer": "지난 3개월 동안 각 판매 팀별로 제품 재고의 총 중량은 {{df.groupby('sales_team')['total_weight'].sum()}}kg이며, 총 금액은 {{df.groupby('sales_team')['total_amount'].sum()}}원입니다. 각 판매 팀의 월별 재고 중량과 금액 추이는 다음과 같습니다.",
  "stats": "sales_team | total_weight\n -------------------------\n 탄합영업실 | 22044580.0\n 봉강내수영업팀 | 6959667.0\n 공구강내수영업팀 | 4493050.0\n 선재내수영업팀 | 3554580.0\n STS수출영업팀 | 2273796.0\n ... (중간 생략) ...\n 압연설비 | 2011.0\n 실수요영업1팀 | 1696.0\n 스틸공정연구그룹 | 1602.0\n 특수합금파트 | 646.0\n 강관생산관리팀 | 335.0"
  },
  {
  "question": "제품 재고 기준으로 팀의 부문별로 구분하여 3개월치에 대한 추이를 보여주세요.",
  "answer": "최근 3개월 동안 제품 재고를 기준으로 팀의 부문별로 구분한 결과, 가장 많은 재고 중량을 가진 부문은 {{df.sort_values('total_weight', ascending=False).iloc[0]['team_division']}}이며, 해당 부문의 총 재고 중량은 {{df.sort_values('total_weight', ascending=False).iloc[0]['total_weight']}}kg 입니다. 또한, 가장 많은 재고 금액을 가진 부문은 {{df.sort_values('total_amount', ascending=False).iloc[0]['team_division']}}이며, 해당 부문의 총 재고 금액은 {{df.sort_values('total_amount', ascending=False).iloc[0]['total_amount']}}원 입니다. 이 기간 동안 전체 재고 중량은 {{df['total_weight'].sum()}}kg이며, 전체 재고 금액은 {{df['total_amount'].sum()}}원 입니다.",
  "stats": "year_month | sales_team | total_weight | total_amount\n -----------------------------------------------------\n 2024-12 | STS수출영업팀 | 2869128.0 | 12933078344\n 2024-12 | 강관생산관리팀 | 335.0 | 2378835\n 2024-12 | 강관영업팀 | 2142028.0 | 17602050331\n 2024-12 | 공구강내수영업팀 | 3950350.0 | 18165217420\n 2024-12 | 공구강수출영업팀 | 1772824.0 | 7888688742\n ... (중간 생략) ...\n 2025-02 | 영업외 공통(창특 | 673065.0 | 5588113375\n 2025-02 | 유통영업2팀 | 5042.0 | 12539454\n 2025-02 | 탄합영업실 | 14223834.0 | 21755505376\n 2025-02 | 특수합금영업팀 | 208734.0 | 7739388078\n 2025-02 | 특수합금파트 | 646.0 | 39412460"
  },
  {
  "question": "제품 재고 기준으로 팀의 본부별로 구분하여 3개월치에 대한 추이를 보여주세요.",
  "answer": "지난 3개월 동안 본부별 제품 재고량을 살펴보면, 가장 많은 재고를 보유한 본부는 {{df.sort_values('total_weight', ascending=False).iloc[0]['team_headquarters']}}로, 총 중량은 {{df.sort_values('total_weight', ascending=False).iloc[0]['total_weight']}}kg이며, 총 금액은 {{df.sort_values('total_weight', ascending=False).iloc[0]['total_amount']}}원입니다. 본부별 총 재고 중량과 금액을 재고 중량이 많은 순으로 정렬한 표는 다음과 같습니다.",
  "stats": "year_month | team_name | total_weight | total_amount\n ----------------------------------------------------\n 2024-12 | | 6475.0 | 9967531\n 2024-12 | STS수출영업팀 | 2869128.0 | 12933078344\n 2024-12 | 강관생산관리팀 | 335.0 | 2378835\n 2024-12 | 강관영업팀 | 2142028.0 | 17602050331\n 2024-12 | 공구강내수영업팀 | 3950350.0 | 18165217420\n ... (중간 생략) ...\n 2025-02 | 영업외 공통(창특 | 673065.0 | 5588113375\n 2025-02 | 유통영업2팀 | 5042.0 | 12539454\n 2025-02 | 탄합영업실 | 14223834.0 | 21755505376\n 2025-02 | 특수합금영업팀 | 208734.0 | 7739388078\n 2025-02 | 특수합금파트 | 646.0 | 39412460"
  },
  {
  "question": "제품 재고 기준으로 영업부문에 대해 팀별로 구분하여 3개월치에 대한 추이를 보여주세요.",
  "answer": "지난 3개월 동안 제품 재고 기준으로 선재내수영업팀, 강관영업팀, 내수영업파트, 수출영업파트, 봉강내수영업팀, 공구강내수영업팀, 특수합금영업팀, STS수출영업팀, 공구강수출영업팀, 탄합영업실 등의 영업팀별로 총 중량은 {{df['total_weight'].sum()}}kg이며, 총 금액은 {{df['total_amount'].sum()}}원입니다. 이 중 가장 많은 재고 금액을 가진 영업팀은 {{df.sort_values('total_amount', ascending=False).iloc[0]['sales_team']}}이며, 해당 팀의 재고 중량은 {{df.sort_values('total_amount', ascending=False).iloc[0]['total_weight']}}kg, 금액은 {{df.sort_values('total_amount', ascending=False).iloc[0]['total_amount']}}원입니다.",
  "stats": "year_month | sales_headquarters | total_weight | total_amount\n -------------------------------------------------------------\n 2024-12 | 영업1본부 | 5636355.0 | 37493359028\n 2024-12 | 영업2본부 | 9975473.0 | 57630687901\n 2024-12 | 영업3본부 | 4641952.0 | 20821767086\n 2024-12 | 탄합영업실 | 15388445.0 | 22587004523\n 2025-01 | 영업1본부 | 4803486.0 | 32799063235\n ... (중간 생략) ...\n 2025-01 | 탄합영업실 | 15043270.0 | 22486374092\n 2025-02 | 영업1본부 | 4284369.0 | 29265138023\n 2025-02 | 영업2본부 | 10792568.0 | 55684846963\n 2025-02 | 영업3본부 | 3675534.0 | 15989829649\n 2025-02 | 탄합영업실 | 14223834.0 | 21755505376"
  },
  {
  "question": "제품 재고 기준으로 기술연구소에 대해 팀별로 구분하여 3개월치에 대한 추이를 보여주세요.",
  "answer": "지난 3개월 동안 제품 재고 기준으로 기술연구소 팀별 추이는 다음과 같습니다. 가장 높은 재고 중량을 가진 팀은 {{df.sort_values('total_weight', ascending=False).iloc[0]['sales_team']}}이며, 해당 팀의 총 재고 중량은 {{df.sort_values('total_weight', ascending=False).iloc[0]['total_weight']}}kg입니다. 가장 높은 재고 금액을 가진 팀은 {{df.sort_values('total_amount', ascending=False).iloc[0]['sales_team']}}이며, 해당 팀의 총 재고 금액은 {{df.sort_values('total_amount', ascending=False).iloc[0]['total_amount']}}원입니다. 전체 기술연구소의 총 재고 중량은 {{df['total_weight'].sum()}}kg이며, 총 재고 금액은 {{df['total_amount'].sum()}}원입니다.",
  "stats": "year_month | team_division | total_weight | total_amount\n --------------------------------------------------------\n 2024-12 | 기술연구소 | 1602.0 | 15475320\n 2024-12 | 기타 | 966642.0 | 8843171074\n 2024-12 | 영업부문 | 35642225.0 | 138532818538\n 2025-01 | 기술연구소 | 1602.0 | 15475320\n 2025-01 | 기타 | 903077.0 | 8787722394\n 2025-01 | 영업부문 | 34245793.0 | 129418004733\n 2025-02 | 기술연구소 | 1602.0 | 15475320\n 2025-02 | 기타 | 815472.0 | 6895156065\n 2025-02 | 영업부문 | 32976305.0 | 122695320011"
  },
  {
  "question": "제품 재고 기준으로 영업부문에 대해 본부별로 구분하여 3개월치에 대한 추이를 보여주세요.",
  "answer": "지난 3개월 동안 영업1본부, 영업2본부, 영업3본부, 탄합영업실 별로 제품 재고의 총 중량과 총 금액을 확인하였습니다. 각 본부별 재고 중량과 금액의 추이를 확인하고자 한다면, 제공된 통계 테이블을 참조해주시기 바랍니다.",
  "stats": "year_month | total_weight | total_amount\n ----------------------------------------\n 2024-12 | 10380503.0 | 21946325780\n 2025-01 | 12163453.0 | 24794642448\n 2025-02 | 12641211.0 | 26513189569"
  },
  {
  "question": "제품 재고 기준으로 R-ORDER 센터에 대해 센터별로 구분하여 3개월치에 대한 추이를 보여주세요.",
  "answer": "지난 3개월 동안 제품연구센터, 공정연구센터, 선도기술연구센터의 R- ORDER 센터별로 총 중량은 {{df.groupby('research_center')['total_weight'].sum()}}kg이고, 총 금액은 {{df.groupby('research_center')['total_amount'].sum()}}원입니다. 센터별로 구분하여 보면, 제품연구센터의 총 중량은 {{df[df['research_center']=='제품연구센터']['total_weight'].sum()}}kg, 총 금액은 {{df[df['research_center']=='제품연구센터']['total_amount'].sum()}}원, 공정연구센터의 총 중량은 {{df[df['research_center']=='공정연구센터']['total_weight'].sum()}}kg, 총 금액은 {{df[df['research_center']=='공정연구센터']['total_amount'].sum()}}원, 선도기술연구센터의 총 중량은 {{df[df['research_center']=='선도기술연구센터']['total_weight'].sum()}}kg, 총 금액은 {{df[df['research_center']=='선도기술연구센터']['total_amount'].sum()}}원입니다.",
  "stats": "year_month | team_headquarters | total_weight | total_amount\n ------------------------------------------------------------\n 2025-02 | 공정연구센터 | 1602.0 | 15475320\n 2025-02 | 기타 | 11399306.0 | 54840614950\n 2025-02 | 영업1본부 | 4284369.0 | 29265138023\n 2025-02 | 영업2본부 | 208734.0 | 7739388078\n 2025-02 | 영업3본부 | 3675534.0 | 15989829649\n 2025-02 | 탄합영업실 | 14223834.0 | 21755505376"
  },
  {
  "question": "2제강 공장에 있는 재공 재고에 대한 월별 추이를 보여주세요.",
  "answer": "2제강 공장의 재공 재고는 월별로 다음과 같이 변화하였습니다. {{df['year_month']}}에는 총 중량이 {{df['total_weight']}}kg이며, 총 금액은 {{df['total_amount']}}원이었습니다.",
  "stats": "year_month | total_weight | total_amount----------------------------------------2024-04 | 19759993.0 | 386675758032024-05 | 17435569.0 | 353215021722024-06 | 19966413.0 | 424194825822024-07 | 24330695.0 | 402746551242024-08 | 21052437.0 | 39277082328... (중간 생략) ...2024-10 | 17950428.0 | 377034540612024-11 | 12786778.0 | 296093507482024-12 | 10380503.0 | 219463257802025-01 | 12163453.0 | 247946424482025-02 | 12641211.0 | 26513189569"
  },
  {
  "question": "합금철 중에서 특수합금 합금철에 대한 24년 분기별 추이를 보여주세요.",
  "answer": "2024년 분기별로 특수합금 합금철의 총 중량은 {{df['total_weight'].sum()}}kg이며, 총 금액은 {{df['total_amount'].sum()}}원입니다. 분기별로 세부적인 중량과 금액은 표를 참조해주세요.",
  "stats": "year_month | team_headquarters | total_weight | total_amount \n------------------------------------------------------------ \n2024-01 | 영업1본부 | 4909187.0 | 36502653613 \n2024-01 | 영업2본부 | 11869569.0 | 58381308088 \n2024-01 | 영업3본부 | 73087.0 | 153048139 \n2024-01 | 탄합영업실 | 16308927.0 | 24156452631 \n2024-02 | 영업1본부 | 5206711.0 | 38590114404 \n... (중간 생략) ... \n2024-11 | 탄합영업실 | 15657503.0 | 22685802689 \n2024-12 | 영업1본부 | 5636355.0 | 37493359028 \n2024-12 | 영업2본부 | 9975473.0 | 57630687901 \n2024-12 | 영업3본부 | 4641952.0 | 20821767086 \n2024-12 | 탄합영업실 | 15388445.0 | 225870045234"
  },
  {
  "question": "소형압연 재공 중에서 STS 선재에 대한 24년 5월 중량, 금액을 알려주세요.",
  "answer": "2024년 5월 소형압연에서의 STS 선재 재공 중량은 {{df['total_weight'].sum()}}kg이며, 총 금액은 {{df['total_amount'].sum()}}원입니다.",
  "stats": "year_month | total_weight | total_amount\n ----------------------------------------\n 2024-05 | 5528224.0 | 45703664403"
  },
  {
  "question": "소형압연 재공 중에서 STS 대강종에 대한 24년 5월 중량, 금액을 알려주세요.",
  "answer": "2024년 5월에 소형압연에서 STS 대강종의 재공 중량은 {{df['total_weight']}}kg이며, 금액은 {{df['total_amount']}}원입니다.",
  "stats": "year_month | team | total_weight | total_amount\n -----------------------------------------------\n 2024-12 | 스틸공정연구그룹 | 1602.0 | 15475320\n 2025-01 | 스틸공정연구그룹 | 1602.0 | 15475320\n 2025-02 | 스틸공정연구그룹 | 1602.0 | 15475320"
  },
  {
  "question": "전체 장기재고에 대한 중량과 금액을 월별로 산출하여 보여주세요.",
  "answer": "선택하신 기간 동안의 장기재고에 대한 월별 총 중량은 {{df['total_weight'].sum()}}kg이며, 총 금액은 {{df['total_amount'].sum()}}원입니다. 월별 상세 내역은 테이블을 참조해주세요.",
  "stats": "year_month | factory_name | total_weight_ton | total_amount_million\n -------------------------------------------------------------------\n 2024-01 | 2단조 | 154.63 | 770.0\n 2024-01 | 2제강 | 326.2 | 825.79\n 2024-01 | 가공 | 204.05 | 802.48\n 2024-01 | 산세 | 47.67 | 183.91\n 2024-02 | 2단조 | 167.53 | 862.27\n ... (중간 생략) ...\n 2025-02 | 가공 | 79.56 | 314.44\n 2025-02 | 대형압연 | 14.99 | 52.37\n 2025-02 | 미분류 | 7.71 | 26.35\n 2025-02 | 산세 | 61.02 | 226.9\n 2025-02 | 소형압연 | 26.22 | 88.42"
  },
  {
  "question": "24년 6월 영업팀별 장기재고의 중량과 금액을 보여주세요.",
  "answer": "2024년 6월에 각 영업팀의 장기재고 중량은 {{df.groupby('sales_team')['total_weight'].sum()}}kg이고, 재고 금액은 {{df.groupby('sales_team')['total_amount'].sum()}}원입니다. 영업팀별 재고 중량과 금액을 확인하시려면 해당 테이블을 참조해주세요.",
  "stats": "year_month | sales_headquarters | total_weight | total_amount\n -------------------------------------------------------------\n 2024-12 | 영업1본부 | 5636355.0 | 37493359028\n 2024-12 | 영업2본부 | 9975473.0 | 57630687901\n 2024-12 | 영업3본부 | 4641952.0 | 20821767086\n 2024-12 | 탄합영업실 | 15388445.0 | 22587004523\n 2025-01 | 영업1본부 | 4803486.0 | 32799063235\n ... (중간 생략) ...\n 2025-01 | 탄합영업실 | 15043270.0 | 22486374092\n 2025-02 | 영업1본부 | 4284369.0 | 29265138023\n 2025-02 | 영업2본부 | 10792568.0 | 55684846963\n 2025-02 | 영업3본부 | 3675534.0 | 15989829649\n 2025-02 | 탄합영업실 | 14223834.0 | 21755505376"
  },
  {
  "question": "24년 6월 영업부문에 대해 영업본부별 장기재고의 중량과 금액을 보여주세요.",
  "answer": "2024년 6월에 영업본부별 장기재고의 중량과 금액은 다음과 같습니다. 영업1본부의 재고 중량은 {{df[df['team_headquarters']=='영업1본부']['total_weight'].values[0]}}kg이며, 금액은 {{df[df['team_headquarters']=='영업1본부']['total_amount'].values[0]}}원입니다. 영업2본부의 재고 중량은 {{df[df['team_headquarters']=='영업2본부']['total_weight'].values[0]}}kg이며, 금액은 {{df[df['team_headquarters']=='영업2본부']['total_amount'].values[0]}}원입니다. 영업3본부의 재고 중량은 {{df[df['team_headquarters']=='영업3본부']['total_weight'].values[0]}}kg이며, 금액은 {{df[df['team_headquarters']=='영업3본부']['total_amount'].values[0]}}원입니다. 마지막으로, 탄합영업실의 재고 중량은 {{df[df['team_headquarters']=='탄합영업실']['total_weight'].values[0]}}kg이며, 금액은 {{df[df['team_headquarters']=='탄합영업실']['total_amount'].values[0]}}원입니다.",
  "stats": "year_month | long_type | type | total_weight | total_amount\n -----------------------------------------------------------\n 2024-01 | 일몰 | 재공 | 1253729.0 | 8813672641\n 2024-01 | 일몰 | 제품 | 445537.0 | 2776951780\n 2024-01 | 장기 | 재공 | 2352655.0 | 19129676919\n 2024-01 | 장기 | 제품 | 986317.0 | 7432392464\n 2024-02 | 일몰 | 재공 | 1141973.0 | 8221809658\n ... (중간 생략) ...\n 2025-01 | 장기 | 제품 | 993102.0 | 7557071330\n 2025-02 | 일몰 | 재공 | 896996.627 | 9346470444\n 2025-02 | 일몰 | 제품 | 472922.0 | 3466794598\n 2025-02 | 장기 | 재공 | 3012190.0 | 24258867302\n 2025-02 | 장기 | 제품 | 956142.0 | 5862754603"
  },
  {
  "question": "재공 중에서 주문재와 여재를 구분하여 전전월과 전월의 중량과 금액을 조회하세요. 월을 컬럼으로 배치하고 전월 대비 당월의 증감을 계산해 표시해 주세요.",
  "answer": "재공 중에서 주문재와 여재를 구분하여 전전월과 전월의 중량과 금액을 조회한 결과, 주문재의 전월 중량은 {{df[df['ORDER_type'] == '주문재']['합계_중량_전월'].values[0]}}kg, 금액은 {{df[df['ORDER_type'] == '주문재']['합계_금액_전월'].values[0]}}원이며, 여재의 전월 중량은 {{df[df['ORDER_type'] == '여재']['합계_중량_전월'].values[0]}}kg, 금액은 {{df[df['ORDER_type'] == '여재']['합계_금액_전월'].values[0]}}원입니다. 주문재의 전월 대비 중량 증감은 {{df[df['ORDER_type'] == '주문재']['중량_전월비'].values[0]}}kg, 금액 증감은 {{df[df['ORDER_type'] == '주문재']['금액_전월비'].values[0]}}원이며, 여재의 전월 대비 중량 증감은 {{df[df['ORDER_type'] == '여재']['중량_전월비'].values[0]}}kg, 금액 증감은 {{df[df['ORDER_type'] == '여재']['금액_전월비'].values[0]}}원입니다.",
  "stats": "year_month | center_name | total_weight | total_amount\n ------------------------------------------------------\n 2024-12 | 특수강 | 349726.0 | 4996454542\n 2025-01 | 특수강 | 316086.0 | 4902797602\n 2025-02 | 특수강 | 270921.0 | 3479569794"
  },
  {
  "question": "R-ORDER를 재공과 제품으로 분류를 한 후 팀별로 24년 7월, 8월의 중량과 금액을 조회하세요. 월을 컬럼으로 표시하고 8월 기준으로 전월비를 계산해 표시하세요. 전월비 감소폭이 큰 순으로 팀을 나열해주세요.",
  "answer": "재공과 제품으로 분류된 R- ORDER의 팀별 2024년 7월, 8월 중량과 금액을 조회한 결과, 중량과 금액의 전월비를 계산하여 8월 기준으로 가장 큰 감소폭을 보인 팀은 {{df.sort_values('중량_전월비', ascending=True).iloc[0]['sales_team']}}로, 중량 전월비는 {{df.sort_values('중량_전월비', ascending=True).iloc[0]['중량_전월비']}}kg, 금액 전월비는 {{df.sort_values('금액_전월비', ascending=True).iloc[0]['금액_전월비']}}원 입니다.",
  "stats": "steel_main_class | shape_type | total_weight | total_amount\n -----------------------------------------------------------\n 공구강 | IGT | 903337.0 | 2501717440\n 공구강 | 공구강평강 | 1803186.0 | 6414342223\n 공구강 | 공구강환봉 | 1237915.0 | 4988900716\n 공구강 | 금형강 | 303820.0 | 644045340\n 공구강 | 미분류 | 186712.0 | 530808133\n ... (중간 생략) ...\n 합금강 | 압연각재 | 611245.0 | 1428372086\n 합금강 | 압연소재 | 243243.0 | 532657151\n 합금강 | 탄합선재 | 166163.0 | 228189145\n 합금강 | 탄합환봉 | 1030033.0 | 4749469546\n 합금강 | 탄합환봉(P) | 94559.0 | 172543238"
  },
  {
  "question": "전월 제품 재고 중 가장 중량이 많은 사내강종에 대해 사내강종명과 장기재고 중량은 얼마인지 알려주세요.",
  "answer": "전월 제품 재고 중 가장 중량이 많은 사내강종은 {{df.sort_values('total_weight', ascending=False).iloc[0]['internal_grade_name']}}이며, 장기재고 중량은 {{df.sort_values('total_weight', ascending=False).iloc[0]['total_long_weight']}}kg입니다.",
  "stats": "year_month | total_weight | total_amount\n ----------------------------------------\n 2024-01 | 16246872.0 | 41005969608\n 2024-02 | 19214921.0 | 42401089425\n 2024-03 | 21931957.0 | 46703585568\n 2024-04 | 19759993.0 | 38667575803\n 2024-05 | 17435569.0 | 35321502172\n ... (중간 생략) ...\n 2024-10 | 17950428.0 | 37703454061\n 2024-11 | 12786778.0 | 29609350748\n 2024-12 | 10380503.0 | 21946325780\n 2025-01 | 12163453.0 | 24794642448\n 2025-02 | 12641211.0 | 26513189569"
  },
  {
  "question": "가장 최근의 제품 재고량을 팀별로 구분하여 비율로 알려주세요.",
  "answer": "가장 최근의 제품 재고량을 팀별로 구분하여 비율로 확인하면, {{df.sort_values('weight_ratio', ascending=False).iloc[0]['sales_team']}} 팀이 가장 높은 비율을 차지하고 있으며, 그 비율은 {{df.sort_values('weight_ratio', ascending=False).iloc[0]['weight_ratio']}}% 입니다. 팀별 제품 재고량 비율을 높은 순으로 정렬한 표는 다음과 같습니다. 총 제품 재고량은 {{df['weight_ratio'].sum()}}% 입니다.",
  "stats": "steel_main_class | total_weight | total_amount\n ----------------------------------------------\n 공구강 | 124600.0 | 477419600\n 베어링강 | 70548.0 | 69842520\n 소입성보증강 | 2095480.0 | 2244035675\n 스테인레스강 | 10498045.0 | 28334138600\n 탄소강 | 5564625.0 | 5203126324\n 특수용도강 | 770111.0 | 717333229\n 특수합금강 | 8300.0 | 75322500\n 합금강 | 1920728.0 | 2155863880"
  },
  {
  "question": "가장 최근의 재공, 제품 장기재고의 중량과 금액을 표시하고 대강종별로의 비율도 같이 표시해주세요.",
  "answer": "가장 최근의 재공, 제품 장기재고의 중량은 {{df.sort_values('total_weight', ascending=False).iloc[0]['total_weight']}}kg이고, 금액은 {{df.sort_values('total_amount', ascending=False).iloc[0]['total_amount']}}원입니다. 또한, 대강종별 중량 비율은 {{df.sort_values('weight_ratio', ascending=False).iloc[0]['major_steel_type']}}가 {{df.sort_values('weight_ratio', ascending=False).iloc[0]['weight_ratio']}}%로 가장 높으며, 금액 비율은 {{df.sort_values('amount_ratio', ascending=False).iloc[0]['major_steel_type']}}가 {{df.sort_values('amount_ratio', ascending=False).iloc[0]['amount_ratio']}}%로 가장 높습니다.",
  "stats": "steel_main_class | shape_type | total_weight | total_amount\n -----------------------------------------------------------\n A(탄소강) | BLM | 220883.0 | 268882876\n A(탄소강) | BLT | 38844095.183 | 36130559038\n A(탄소강) | IGT | 19701.0 | 80905082\n A(탄소강) | 강관_압출전 | 287100.0 | 572136288\n A(탄소강) | 공구강평강 | 4944.0 | 10204416\n ... (중간 생략) ...\n V(특수합금강) | 압연BLT | 405180.0 | 10275287004\n V(특수합금강) | 압연각재 | 53040.0 | 1438059670\n V(특수합금강) | 압연소재 | 9964333.0 | 231935646513\n V(특수합금강) | 자단품 | 214980.0 | 7209802607\n V(특수합금강) | 탄합선재 | 806309.0 | 28536481358"
  },
  {
  "question": "재공, 제품 장기재고의 중량과 금액을 표시하고 강종 대분류별로의 비율도 같이 표시해주세요.",
  "answer": "재공, 제품 장기재고의 중량과 금액은 각각 {{df['total_weight'].sum()}}kg, {{df['total_amount'].sum()}}원이며, 강종 대분류별 중량 비율과 금액 비율은 다음과 같습니다.",
  "stats": "factory | steel_main_class | total_weight\n -----------------------------------------\n 1단조 | B(합금강) | 7289.0\n 1단조 | S(스테인레스강) | 90578.0\n 1단조 | T(공구강) | 36593.0\n 1단조 | V(특수합금강) | 73546.0\n 2단조 | B(합금강) | 43196.0\n ... (중간 생략) ...\n 특수제강 | B(합금강) | 185663.0\n 특수제강 | C(소입성보증강) | 5617.0\n 특수제강 | S(스테인레스강) | 280431.0\n 특수제강 | T(공구강) | 83731.0\n 특수제강 | V(특수합금강) | 397893.0"
  },
  {
  "question": "재공의 장기재고 중에서 전월 기준 장기재고 중량이 가장 큰 사내강종이 무엇인지 표시해주세요.",
  "answer": "전월 기준으로 재공의 장기재고 중량이 가장 큰 사내강종은 {{df.sort_values('total_long_weight', ascending=False).iloc[0]['internal_grade_name']}}이며, 그 중량은 {{df.sort_values('total_long_weight', ascending=False).iloc[0]['total_long_weight']}}kg입니다.",
  "stats": "total_weight | total_amount\n ---------------------------\n 1137139.0 | 4385655175.0"
  },
  {
  "question": "STS304S5 강종의 월별 재공 추이를 공장별로 표시해주세요. 중량과 금액 모두 표시가 필요하며 단위는 톤, 백만원으로 해주세요.",
  "answer": "STS304S5 강종의 월별 재공 추이를 공장별로 확인하였습니다. 각 공장에서의 총 중량은 {{df['total_weight_ton'].sum()}}톤이며, 총 금액은 {{df['total_amount_million'].sum()}} 백만원입니다. 공장별로 상세한 중량과 금액 정보는 테이블을 참조해주세요.",
  "stats": "total_weight_thousand_ton | total_amount_billion | internal_grade_name | total_weight_by_grade\n ----------------------------------------------------------------------------------------------\n 1.21 | 50.52 | 304LDS1 | 1208963.0\n 1.05 | 61.18 | 316LDS1 | 1049663.0\n 1.02 | 88.14 | TP304/304LS1 | 1020589.0\n 0.63 | 34.73 | 316LDSB | 632997.0\n 0.6 | 20.55 | STS304SX | 601601.0\n ... (중간 생략) ...\n 0.0 | 0.03 | S174HIGS1 | 247.0\n 0.0 | 0.01 | TP304/304LS6 | 120.0\n 0.0 | 0.01 | TP316/316LS6 | 90.0\n 0.0 | 0.01 | STS304TKAS5 | 74.0\n 0.0 | 0.0 | TP347HS1 | 39.0"
  },
  {
  "question": "특수합금의 최근 3개월 재공, 제품의 월별 중량, 금액을 보여주세요.",
  "answer": "특수합금의 최근 3개월 동안의 월별 재공 중량은 각각 {{df['total_weight'].values}}kg이며, 해당 월별 재공 금액은 각각 {{df['total_amount'].values}}원입니다.",
  "stats": "year_month | total_weight | total_amount\n ----------------------------------------\n 2024-01 | 5038238.0 | 38152693804\n 2024-02 | 5077392.0 | 40463090187\n 2024-03 | 5334334.0 | 41828284274\n 2024-04 | 5315398.0 | 41791484288\n 2024-05 | 5528224.0 | 45703664403\n ... (중간 생략) ...\n 2024-10 | 5234439.0 | 44084783254\n 2024-11 | 5330436.0 | 45603839755\n 2024-12 | 5226620.627 | 44288830798\n 2025-01 | 5204314.627 | 44609993725\n 2025-02 | 5338250.627 | 42934886947"
  },
  {
  "question": "장기재고(제품, 재공)을 24년 1월부터 월별로 장기, 일몰을 구분하여 표시해주세요.",
  "answer": "2024년 1월부터 월별로 장기재고와 일몰재고의 총 중량을 확인하실 수 있습니다. 각 월별로 장기재고와 일몰재고의 중량을 {{df.groupby(['year_month', 'long_type'])['total_weight'].sum()}}kg로 확인하실 수 있습니다.",
  "stats": "total_weight | total_amount\n ---------------------------\n 1167751531.062 | 4653142699697.0"
  },
  {
  "question": "24년 8월 전체 재공을 대강종과 형상으로 구분하여 중량, 금액을 표시해주세요.",
  "answer": "2024년 8월의 전체 재공은 대강종과 형상에 따라 구분되어 있으며, 각각의 총 중량은 {{df.groupby(['major_steel_type', 'shape_type'])['total_weight'].sum()}}kg이고, 총 금액은 {{df.groupby(['major_steel_type', 'shape_type'])['total_amount'].sum()}}원입니다.",
  "stats": "sales_team | total_weight | total_amount\n ----------------------------------------\n | 2138637.0 | 12196938145\n ASTRO사업단 | 3291.0 | 146094095\n CS팀 | 7320.0 | 37542956\n STS수출영업팀 | 2718.0 | 19787679\n 강관기술 | 93713.0 | 387699756\n ... (중간 생략) ...\n 타이타늄연구그룹 | 1780.0 | 61609034\n 탄합영업실 | 137656.0 | 216818164\n 특수합금연구그룹 | 82239.0 | 2841821415\n 특수합금영업팀 | 246617.0 | 7241603384\n 품질기획팀 | 596.0 | 25885870"
  },
  {
  "question": "24년 8월 전체 재공을 강종 대분류와 형상으로 구분하여 중량, 금액을 표시해주세요.",
  "answer": "2024년 8월의 전체 재공은 강종 대분류와 형상별로 구분하였을 때, 각각의 분류별 총 중량은 {{df.groupby(['steel_main_class', 'shape_type'])['total_weight'].sum()}}kg이며, 총 금액은 {{df.groupby(['steel_main_class', 'shape_type'])['total_amount'].sum()}}원입니다. 각 분류별로 정리한 표는 다음과 같습니다.",
  "stats": "steel_main_class | total_weight | total_amount\n ----------------------------------------------\n A(탄소강) | 58788151.0 | 53902195996\n B(합금강) | 24378627.0 | 26012621658\n C(소입성보증강) | 12823230.0 | 13194933652\n K(베어링강) | 757460.0 | 720586290\n M(특수용도강) | 6325916.0 | 5755951092\n S(스테인레스강) | 124286685.0 | 363456552624\n T(공구강) | 1094552.0 | 3884562745\n V(특수합금강) | 132841.0 | 1248757390"
  },
  {
  "question": "전체 재고중에서 판매처가 강관영업팀인 대상에 대해 전체 중량과 금액을 월별로 표시해주세요.",
  "answer": "강관영업팀에서 판매한 제품의 월별 총 중량은 {{df['total_weight'].sum()}}kg이며, 총 금액은 {{df['total_amount'].sum()}}원입니다.",
  "stats": "sales_headquarters | total_weight | total_amount\n ------------------------------------------------\n 기타 | 3076638.0 | 21961640430\n 영업1본부 | 1130821.0 | 9996740497\n 영업2본부 | 688931.0 | 9244919588\n 영업3본부 | 26302.0 | 125935737\n 탄합영업실 | 137656.0 | 216818164"
  },
  {
  "question": "최근 3개월의 장기재고 중량 추이를 조회하고, 각 월별로 장기재고 중량이 가장 큰 대강종을 표시해주세요.",
  "answer": "최근 3개월 동안 장기재고 중량이 가장 큰 대강종은 {{df.sort_values('total_weight', ascending=False).iloc[0]['최대_대강종']}}이며, 해당 월의 총 장기재고 중량은 {{df.sort_values('total_weight', ascending=False).iloc[0]['total_weight']}}kg입니다. 각 월별 장기재고 중량과 가장 큰 대강종을 확인한 표는 다음과 같습니다.",
  "stats": "year_month | sales_team | total_weight_thousand_ton | total_amount_million\n --------------------------------------------------------------------------\n 2024-03 | | 1.21 | 12534.84\n 2024-03 | CS팀 | 0.0 | 4.29\n 2024-03 | STS수출영업팀 | 0.15 | 796.16\n 2024-03 | 강관개발파트 | 0.0 | 18.61\n 2024-03 | 강관영업팀 | 0.0 | 26.31\n ... (중간 생략) ...\n 2024-03 | 유통영업2팀 | 0.01 | 15.88\n 2024-03 | 타이타늄연구그룹 | 0.01 | 352.47\n 2024-03 | 탄합영업실 | 0.09 | 149.37\n 2024-03 | 특수합금연구그룹 | 0.38 | 13691.13\n 2024-03 | 특수합금영업팀 | 0.0 | 132.74"
  },
  {
  "question": "24년 7,8,9월의 장기재고를 대강종 별로 조회하세요. 월을 컬럼으로 전환한 후 대강종 별로 8월과 9월 기준으로 전월 대비 증감을 계산해 표시해주세요.",
  "answer": "2024년 7월, 8월, 9월 각 월의 장기재고를 대강종 별로 조회한 결과는 통계 테이블에 나와 있습니다. 이를 통해 각 대강종 별로 8월과 9월의 재고 중량이 전월 대비 얼마나 증감했는지를 계산하였습니다. 구체적인 수치는 통계 테이블을 참조해주시기 바랍니다.",
  "stats": "year_month | factory_name | total_weight_ton | total_amount_million\n -------------------------------------------------------------------\n 2024-01 | 2단조 | 154.63 | 770.0\n 2024-01 | 2제강 | 326.2 | 825.79\n 2024-01 | 가공 | 204.05 | 802.48\n 2024-01 | 산세 | 47.67 | 183.91\n 2024-02 | 2단조 | 167.53 | 862.27\n ... (중간 생략) ...\n 2025-02 | 가공 | 79.56 | 314.44\n 2025-02 | 대형압연 | 14.99 | 52.37\n 2025-02 | 미분류 | 7.71 | 26.35\n 2025-02 | 산세 | 61.02 | 226.9\n 2025-02 | 소형압연 | 26.22 | 88.42"
  },
  {
  "question": "24년 7,8,9월의 장기재고를 대강종 별로 조회하세요. 월을 컬럼으로 전환해 대강종 별로 8월과 9월 기준으로 전월 대비 증감을 계산하세요. 8월과 9월 각각에 대해 상승폭이 가장 큰 대강종을 표시해주세요.",
  "answer": "2024년 8월에는 {{df.sort_values('중량_전월비', ascending=False).iloc[0]['대강종']}}이 전월 대비 증가폭이 가장 크며, 증가량은 {{df.sort_values('중량_전월비', ascending=False).iloc[0]['중량_전월비']}}kg입니다. 또한, 2024년 9월에는 {{df.sort_values('중량_전월비', ascending=False).iloc[1]['대강종']}}이 전월 대비 증가폭이 가장 크며, 증가량은 {{df.sort_values('중량_전월비', ascending=False).iloc[1]['중량_전월비']}}kg입니다.",
  "stats": "total_weight_thousand_ton | total_amount_billion | internal_grade_name | total_weight_by_grade\n ----------------------------------------------------------------------------------------------\n 182.87 | 10248.31 | 304LDS1 | 18568232.0\n 182.87 | 10248.31 | 316LDS1 | 13847435.0\n 182.87 | 10248.31 | TP304/304LS1 | 12674137.0\n 182.87 | 10248.31 | STS410S1 | 6013264.0\n 182.87 | 10248.31 | EP316LTPS6 | 4724279.0\n ... (중간 생략) ...\n 182.87 | 10248.31 | STS630AS5 | 0.0\n 182.87 | 10248.31 | ER308S8 | 0.0\n 182.87 | 10248.31 | F9S1 | 0.0\n 182.87 | 10248.31 | TP347S2 | 0.0\n 182.87 | 10248.31 | STS304LNTS1 | 0.0"
  },
  {
  "question": "2제강 공장의 24년 8월 재공에 대해서 대강종 기준으로 분류하여 중량과 금액을 표시해주세요.",
  "answer": "2024년 8월에 2제강 공장에서는 대강종 별로 {{df.groupby('major_steel_type')['total_weight'].sum()}}kg의 중량과 {{df.groupby('major_steel_type')['total_amount'].sum()}}원의 금액이 재공되었습니다.",
  "stats": "year_month | product_wip_type | total_weight_ton | total_amount_billion\n -----------------------------------------------------------------------\n 2024-12 | 재공 | 1472.52 | 427.01\n 2024-12 | 제품 | 384.21 | 150.84\n 2025-01 | 재공 | 1400.37 | 403.08\n 2025-01 | 제품 | 380.65 | 134.91\n 2025-02 | 재공 | 1584.41 | 415.71\n 2025-02 | 제품 | 283.76 | 106.89"
  },
  {
  "question": "2제강 공장의 24년 8월 재공에 대해서 강종 대분류 기준으로 분류하여 중량과 금액을 표시해주세요.",
  "answer": "2024년 8월에 2제강 공장에서는 강종 대분류별로 다음과 같은 재공 중량과 금액이 확인되었습니다. {{df.sort_values('total_weight', ascending=False).iloc[0]['steel_main_class']}}의 총 중량은 {{df.sort_values('total_weight', ascending=False).iloc[0]['total_weight']}}kg이며, 총 금액은 {{df.sort_values('total_weight', ascending=False).iloc[0]['total_amount']}}원입니다. 강종 대분류별 총 중량과 금액을 중량이 큰 순으로 정렬한 표는 다음과 같습니다. 이 기간 동안의 총 재공 중량은 {{df['total_weight'].sum()}}kg이며, 총 금액은 {{df['total_amount'].sum()}} 원입니다.",
  "stats": "total_weight | total_amount\n ---------------------------\n 1167751531.062 | 4653142699697.0"
  },
  {
  "question": "24년 9월 제품 재고 중에서 R-ORDER 가 차지하는 중량과 비율을 표시해주세요.",
  "answer": "2024년 9월 제품 재고 중에서 R- ORDER가 차지하는 중량은 {{df['R_ ORDER_중량'].values[0]}}kg이며, 비율은 {{df['R_ ORDER_비율'].values[0]}}%입니다.",
  "stats": "year_month | long_type | type | total_weight | total_amount\n -----------------------------------------------------------\n 2024-09 | 일몰 | 재공 | 1253729.0 | 8813672641\n 2024-09 | 일몰 | 제품 | 445537.0 | 2776951780\n 2024-09 | 장기 | 재공 | 2352655.0 | 19129676919\n 2024-09 | 장기 | 제품 | 986317.0 | 7432392464"
  },
  {
  "question": "24년 7월 제품 재고에 대해 장기재고가 총 몇 톤인지 표시하고 장기재고에 해당되는 대상들을 체공월수가 작은 순으로 표시해주세요.",
  "answer": "2024년 7월 제품 재고 중 장기재고의 총 중량은 {{df['total_weight_ton'].sum()}}톤이며, 장기재고에 해당되는 대상들은 체공월수가 작은 순으로 {{df.sort_values('elapsed_month')['pon_lot'].tolist()}}입니다.",
  "stats": "year_month | sales_team | total_weight_thousand_ton | total_amount_million\n --------------------------------------------------------------------------\n 2024-07 | | 1.21 | 12534.84\n 2024-07 | CS팀 | 0.0 | 4.29\n 2024-07 | STS수출영업팀 | 0.15 | 796.16\n 2024-07 | 강관개발파트 | 0.0 | 18.61\n 2024-07 | 강관영업팀 | 0.0 | 26.31"
  },
  {
  "question": "24년 7월의 재공 재고를 대상으로 공장별 중량을 계산하고 그 중량을 다시 대강종별로 나눠 표시해주세요.",
  "answer": "2024년 7월의 재공 재고를 대상으로 각 공장에서의 총 중량은 {{df.groupby('공장명')['total_weight'].sum()}}kg이며, 이 중량을 대강종별로 나누면 {{df.groupby('major_steel_type')['total_weight'].sum()}}kg입니다. 각 공장과 대강종별 중량을 확인하려면 해당 테이블을 참조하십시오.",
  "stats": "major_steel_type | shape_type | total_weight | total_amount\n -----------------------------------------------------------\n STS | BLM | 2206812.0 | 8562572213\n STS | BLT | 11805209.0 | 32049657418\n STS | IGT | 1639251.0 | 7607235134\n STS | STS선재 | 2192733.0 | 8418508232\n STS | STS평강 | 763504.0 | 3820049089\n ... (중간 생략) ...\n 특수합금 | 압연BLT | 95171.0 | 2886497541\n 특수합금 | 압연각재 | 4410.0 | 122262840\n 특수합금 | 압연소재 | 372733.0 | 9131846737\n 특수합금 | 자단품 | 20922.0 | 737088858\n 특수합금 | 탄합선재 | 138225.0 | 4950341078"
  },
  {
  "question": "24년 7월의 재공 재고를 대상으로 공장별 중량을 계산하고 그 중량을 다시 강종 대분류별로 나눠 표시해주세요.",
  "answer": "2024년 7월의 재공 재고를 대상으로, 각 공장에서의 총 중량은 {{df.groupby('공장명')['total_weight'].sum()}}kg이며, 이 중량을 강종 대분류별로 나누면 {{df.groupby('steel_main_class')['total_weight'].sum()}}kg입니다. 이 정보를 통해 각 공장과 강종별 재고 중량을 확인할 수 있습니다.",
  "stats": "total_weight_thousand_ton | total_amount_billion | internal_grade_name | total_weight_by_grade\n ----------------------------------------------------------------------------------------------\n 182.87 | 10248.31 | 304LDS1 | 18568232.0\n 182.87 | 10248.31 | 316LDS1 | 13847435.0\n 182.87 | 10248.31 | TP304/304LS1 | 12674137.0\n 182.87 | 10248.31 | STS410S1 | 6013264.0\n 182.87 | 10248.31 | EP316LTPS6 | 4724279.0\n ... (중간 생략) ...\n 182.87 | 10248.31 | STS630AS5 | 0.0\n 182.87 | 10248.31 | ER308S8 | 0.0\n 182.87 | 10248.31 | F9S1 | 0.0\n 182.87 | 10248.31 | TP347S2 | 0.0\n 182.87 | 10248.31 | STS304LNTS1 | 0.0"
  },
  {
  "question": "24년 전체 재고를 제품과 재공 각 카테고리별 월별 추이로 표시해주세요.",
  "answer": "2024년 동안, 각 제품과 재공 유형별로 월별 총 중량은 {{df.groupby(['year_month', 'product_wip_type'])['total_weight'].sum()}}kg이며, 총 금액은 {{df.groupby(['year_month', 'product_wip_type'])['total_amount'].sum()}}원입니다. 이는 제품과 재공 유형별 월별 재고 추이를 보여줍니다.",
  "stats": "steel_main_class | shape_type | total_weight | total_amount\n -----------------------------------------------------------\n 공구강 | IGT | 903337.0 | 2501717440\n 공구강 | 공구강평강 | 1803186.0 | 6414342223\n 공구강 | 공구강환봉 | 1237915.0 | 4988900716\n 공구강 | 금형강 | 303820.0 | 644045340\n 공구강 | 미분류 | 186712.0 | 530808133\n ... (중간 생략) ...\n 합금강 | 압연각재 | 611245.0 | 1428372086\n 합금강 | 압연소재 | 243243.0 | 532657151\n 합금강 | 탄합선재 | 166163.0 | 228189145\n 합금강 | 탄합환봉 | 1030033.0 | 4749469546\n 합금강 | 탄합환봉(P) | 94559.0 | 172543238"
  },
  {
  "question": "가장 최근 월의 제품 재고에 대해 전체 중량을 표시하고 판매팀별로도 표시하되 본부를 구분하여 표시해주세요. 팀은 중량순으로 내림차순해주세요.",
  "answer": "가장 최근 월의 전체 제품 재고 중량은 {{df['total_all_weight'].sum()}}kg이며, 본부별로 나누어 보면 영업1본부, 영업2본부, 영업3본부, 탄합영업실, 제품연구센터, 공정연구센터, 선도기술연구센터, CS팀, 그리고 품질생산등 본부의 판매팀별 재고 중량을 확인할 수 있습니다. 각 판매팀의 재고 중량은 {{df.sort_values('total_weight', ascending=False).iloc[0]['sales_team']}}팀이 가장 많았습니다.",
  "stats": "total_weight | total_amount\n ---------------------------\n 1167751531.062 | 4653142699697.0"
  },
  {
  "question": "최근 3개월의 특수합금 합금철에 대해 제품/재공으로 분류해 중량과 금액을 보여주세요. 톤과 억원 단위로 표시해주세요.",
  "answer": "최근 3개월 동안 특수합금 합금철의 제품/재공 분류에 따른 총 중량은 {{df['total_weight_ton'].sum()}}톤이며, 총 금액은 {{df['total_amount_billion'].sum()}}억원입니다.",
  "stats": "year_month | total_weight | total_amount\n ----------------------------------------\n 2024-01 | 1637574.0 | 15840841220\n 2024-02 | 1550376.0 | 15135754607\n 2024-03 | 1457548.0 | 14378038855\n 2024-04 | 1467780.0 | 14214494567\n 2024-05 | 1323446.0 | 12857337995\n ... (중간 생략) ...\n 2024-10 | 2935872.0 | 25847244158\n 2024-11 | 3603125.0 | 29213517011\n 2024-12 | 4081663.0 | 33824051173\n 2025-01 | 3833153.0 | 34555404377\n 2025-02 | 3661602.0 | 33071044058"
  },
  {
  "question": "연구소 R-ORDER에 대해서 최근 2개월 중량과 금액을 팀별로 구분하여 보여주세요. 단위는 천톤, 백만원으로 나타내 주세요.",
  "answer": "연구소 R- ORDER에서 최근 2개월 동안 각 판매 팀의 총 중량은 {{df.groupby('sales_team')['total_weight_thousand_ton'].sum()}} 천톤이며, 총 금액은 {{df.groupby('sales_team')['total_amount_million'].sum()}} 백만원입니다. 판매 팀별로 구분된 중량과 금액을 확인하실 수 있습니다.",
  "stats": "year_month | sales_team | total_weight_thousand_ton | total_amount_million\n --------------------------------------------------------------------------\n 2024-03 | | 1.21 | 12534.84\n 2024-03 | CS팀 | 0.0 | 4.29\n 2024-03 | STS수출영업팀 | 0.15 | 796.16\n 2024-03 | 강관개발파트 | 0.0 | 18.61\n 2024-03 | 강관영업팀 | 0.0 | 26.31\n ... (중간 생략) ...\n 2024-03 | 유통영업2팀 | 0.01 | 15.88\n 2024-03 | 타이타늄연구그룹 | 0.01 | 352.47\n 2024-03 | 탄합영업실 | 0.09 | 149.37\n 2024-03 | 특수합금연구그룹 | 0.38 | 13691.13\n 2024-03 | 특수합금영업팀 | 0.0 | 132.74"
  },
  {
  "question": "연구소 R-ORDER에 대해서 최근 2개월 중량과 금액을 R-ORDER 센터별로 구분하여 보여주세요. 단위는 천톤, 백만원으로 나타내 주세요.",
  "answer": "최근 2개월 동안 제품연구센터의 R- ORDER 중량은 {{df[df['research_center'] == '제품연구센터']['total_weight_thousand_ton'].sum()}} 천톤이며, 금액은 {{df[df['research_center'] == '제품연구센터']['total_amount_million'].sum()}} 백만원입니다. 공정연구센터의 R- ORDER 중량은 {{df[df['research_center'] == '공정연구센터']['total_weight_thousand_ton'].sum()}} 천톤이며, 금액은 {{df[df['research_center'] == '공정연구센터']['total_amount_million'].sum()}} 백만원입니다. 선도기술연구센터의 R- ORDER 중량은 {{df[df['research_center'] == '선도기술연구센터']['total_weight_thousand_ton'].sum()}} 천톤이며, 금액은 {{df[df['research_center'] == '선도기술연구센터']['total_amount_million'].sum()}} 백만원입니다.",
  "stats": "major_steel_type | total_weight | total_amount\n ----------------------------------------------\n STS | 10498045.0 | 28334138600\n 공구강 | 124600.0 | 477419600\n 탄합강 | 10421492.0 | 10390201628\n 특수합금 | 8300.0 | 75322500"
  },
  {
  "question": "24년 9월 전체 제품 재고 중에서 대강종 S에 대해 전체 중량과 금액을 천톤, 억원 단위로 나타내고 사내강종별로 중량 기준 내림차순으로 보여주세요.",
  "answer": "2024년 9월에 전체 제품 재고 중 대강종 S의 총 중량은 {{df['total_weight_thousand_ton'].sum()}} 천톤이며, 총 금액은 {{df['total_amount_billion'].sum()}} 억원입니다. 사내강종별로 중량을 내림차순으로 정렬한 결과는 다음과 같습니다.}}",
  "stats": "total_weight_thousand_ton | total_amount_billion | internal_grade_name | total_weight_by_grade\n ----------------------------------------------------------------------------------------------\n 182.87 | 10248.31 | 304LDS1 | 18568232.0\n 182.87 | 10248.31 | 316LDS1 | 13847435.0\n 182.87 | 10248.31 | TP304/304LS1 | 12674137.0\n 182.87 | 10248.31 | STS410S1 | 6013264.0\n 182.87 | 10248.31 | EP316LTPS6 | 4724279.0\n ... (중간 생략) ...\n 182.87 | 10248.31 | STS630AS5 | 0.0\n 182.87 | 10248.31 | ER308S8 | 0.0\n 182.87 | 10248.31 | F9S1 | 0.0\n 182.87 | 10248.31 | TP347S2 | 0.0\n 182.87 | 10248.31 | STS304LNTS1 | 0.0"
  },
  {
  "question": "24년 9월 전체 제품 재고 중에서 STS 대강종에 대해 전체 중량과 금액을 천톤, 억원 단위로 나타내고 사내강종별로 중량 기준 내림차순으로 보여주세요.",
  "answer": "2024년 9월에 전체 제품 재고 중 STS 대강종의 총 중량은 {{df['total_weight_thousand_ton'].sum()}} 천톤이며, 총 금액은 {{df['total_amount_billion'].sum()}} 억원입니다. 사내강종별로 중량을 내림차순으로 정렬한 결과는 다음과 같습니다.",
  "stats": "steel_main_class | total_weight | total_amount\n ----------------------------------------------\n 공구강 | 124600.0 | 477419600\n 베어링강 | 70548.0 | 69842520\n 소입성보증강 | 2095480.0 | 2244035675\n 스테인레스강 | 10498045.0 | 28334138600\n 탄소강 | 5564625.0 | 5203126324\n 특수용도강 | 770111.0 | 717333229\n 특수합금강 | 8300.0 | 75322500\n 합금강 | 1920728.0 | 2155863880"
  },
  {
    "question": "지난 달 총 자재 중량과 금액을 표시하세요.",
    "answer": "지난 달 총 자재 중량은 {{df['total_weight'].sum()}}kg이며, 총 금액은  {{df['total_amount'].sum()}}원입니다.",
    "stats": "total_weight | total_amount\n---------------------------\n |40832675.0 | 99404999072.0 \n"
  },
  {
    "question": "지난 달 평가클래스별 자재 중량과 금액을 원료 금액이 큰 순으로 표시하세요.",
    "answer": "지난 달 평가 클래스 중에서  {{df.sort_values('total_amount', ascending=False).iloc[0]['eval_class_name']}} 클래스의 원료 중량이 가장 많았으며, 총 중량은  {{df.sort_values('total_amount', ascending=False).iloc[0]['total_weight']}}kg이었습니다. 또한, 이 클래스의 원료 총 금액은  {{df.sort_values('total_amount', ascending=False).iloc[0]['total_amount']}}원으로 가장 높았습니다. 평가 클래스별 원료 중량과 금액을 원료 금액이 큰 순으로 정렬한 표는 다음과 같습니다.",
    "stats": "year_month | total_weight | total_amount\n----------------------------------------\n2025-02 | 40832675.0 | 99404999072.0\n"
  },
  {
    "question": "지난 달 자재 유형별 자재 중량과 금액을 원료 중량이 큰 순으로 표시하세요.",
    "answer": "지난 달 자재 유형별로 가장 많은 중량을 차지한 자재는  {{df.sort_values('total_weight', ascending=False).iloc[0]['material_type_name']}}이며, 해당 자재의 총 중량은  {{df.sort_values('total_weight', ascending=False).iloc[0]['total_weight']}}kg, 총 금액은  {{df.sort_values('total_weight', ascending=False).iloc[0]['total_amount']}}원입니다. 자재 유형별 총 중량과 금액을 중량이 큰 순으로 정렬한 표는 다음과 같습니다.",
    "stats": "sap_category_l1 | total_weight\n------------------------------\n스크랩 | 36704680.0\n합금철 | 4647310.0\n구입소재 | 397336.0\n"
  },
  {
    "question": "최근 3개월의 총 자재 중량과 금액을 월별로 표시하세요.",
    "answer": "최근 3개월 동안의 월별 총 자재 중량과 금액은 다음과 같습니다:  {{df['year_month'].values}}에 해당하는 총 자재 중량은 각각  {{df['total_weight'].values}}kg이며, 총 금액은 각각  {{df['total_amount'].values}}원입니다.",
    "stats": "year_month | sap_category_l1 | total_weight | total_amount\n----------------------------------------------------------\n2024-12 | 구입소재 | 620669.0 | 982374863.0\n2024-12 | 스크랩 | 36519851.0 | 67758170767.0\n2024-12 | 합금철 | 5250662.0 | 35079452634.0\n2025-01 | 구입소재 | 458881.0 | 868679063.0\n2025-01 | 스크랩 | 32059143.0 | 65564900879.0\n2025-01 | 합금철 | 5159868.0 | 35605277955.0\n2025-02 |  | 0.0 | 0.0\n2025-02 | 구입소재 | 841615.0 | 1342212604.0\n2025-02 | 스크랩 | 34883472.0 | 63244996038.0\n2025-02 | 합금철 | 5107588.0 | 34817790430.0\n"
  },
  {
    "question": "최근 3개월 평가클래스별 자재 중량과 금액을 월별로 표시하세요.",
    "answer": "최근 3개월 동안 평가 클래스별로 월별 자재 중량과 금액이 집계되었습니다. 각 평가 클래스의 총 중량은  {{df.groupby('eval_class_name')['total_weight'].sum()}}kg이며, 총 금액은  {{df.groupby('eval_class_name')['total_amount'].sum()}}원입니다. 월별로 분류된 자세한 정보는 다음 테이블을 참조하세요.",
    "stats": "main_category | total_weight\n----------------------------\n구입스크랩 | 28168787.0\n자가철스크랩 | 8535893.0\n합금철 | 4647310.0\n구입소재 | 397336.0\n"
  },
  {
    "question": "24년 9월 기준으로 SAP 대분류별 자재 중량을 중량이 큰 순으로 나열하세요.",
    "answer": "2024년 9월 기준으로 SAP 대분류별 자재 중량이 가장 큰 항목은  {{df.sort_values('total_weight', ascending=False).iloc[0]['sap_category_l1']}}이며, 그 중량은  {{df.sort_values('total_weight', ascending=False).iloc[0]['total_weight']}}kg입니다. SAP 대분류별 자재 중량을 중량이 큰 순으로 정렬한 표는 다음과 같습니다.",
    "stats": "year_month | category | total_weight | total_amount\n---------------------------------------------------\n2024-12 | 구입스크랩 | 27041090.0 | 31855527131.0\n2024-12 | 기타 | 620669.0 | 982374863.0\n2024-12 | 자가철스크랩 | 9478761.0 | 35902643636.0\n2024-12 | 합금철 | 5250662.0 | 35079452634.0\n2025-01 | 구입스크랩 | 22589342.0 | 29210304560.0\n... (중간 생략) ...\n2025-01 | 합금철 | 5159868.0 | 35605277955.0\n2025-02 | 구입스크랩 | 25340802.0 | 27387514296.0\n2025-02 | 기타 | 841615.0 | 1342212604.0\n2025-02 | 자가철스크랩 | 9542670.0 | 35857481742.0\n2025-02 | 합금철 | 5107588.0 | 34817790430.0\n"
  },
  {
    "question": "자재에 대해 SAP 대분류 별로 구분하여 3개월치에 대한 추이를 보여주세요.",
    "answer": "지난 3개월 동안 SAP 대분류 별로 구분한 자재의 총 중량은  {{df['total_weight'].sum()}}kg이며, 총 금액은  {{df['total_amount'].sum()}}원입니다. 각 대분류 별 자재 중량과 금액의 추이는 테이블로 확인하실 수 있습니다.",
    "stats": "year_month | category | total_weight | total_amount\n---------------------------------------------------\n2024-12 | STS스크랩 | 10486053.0 | 19447631699.0\n2024-12 | 특수합금강 | 319316.0 | 3799997681.0\n2025-01 | STS스크랩 | 9365440.0 | 17882934840.0\n2025-01 | 특수합금강 | 319316.0 | 3799997681.0\n2025-02 | STS스크랩 | 8614515.0 | 14348711951.0\n2025-02 | 특수합금강 | 311406.0 | 3738900380.0\n"
  },
  {
    "question": "24년 9월 기준으로 구입스크랩, 자가철스크랩, 합금철, 구입소재로 분류하여 중량이 큰 순으로 중량을 표시하세요.",
    "answer": "2024년 9월 기준으로 구입스크랩, 자가철스크랩, 합금철, 구입소재로 분류하여 중량이 가장 큰 항목은  {{df.sort_values('total_weight', ascending=False).iloc[0]['main_category']}}이며, 그 중량은  {{df.sort_values('total_weight', ascending=False).iloc[0]['total_weight']}}kg입니다. 각 카테고리별 중량을 큰 순으로 정렬한 표는 다음과 같습니다.",
    "stats": "year_month | category | total_weight | total_amount\n---------------------------------------------------\n2024-12 | STS | 5055941.0 | 9712005050.0\n2024-12 | 공구강 | 760010.0 | 950296155.0\n2024-12 | 탄합강 | 2089419.0 | 1042348241.0\n2024-12 | 특수합금강 | 1573391.0 | 24197994190.0\n2025-01 | STS | 5344226.0 | 10623336162.0\n... (중간 생략) ...\n2025-01 | 특수합금강 | 1553792.0 | 24021132073.0\n2025-02 | STS | 5481954.0 | 10467866833.0\n2025-02 | 공구강 | 466626.0 | 588699011.0\n2025-02 | 탄합강 | 2083331.0 | 1032010974.0\n2025-02 | 특수합금강 | 1510759.0 | 23768904924.0\n"
  },
  {
    "question": "자재에 대해 구입스크랩, 자가철스크랩, 합금철, 구입소재로 구분하여 3개월치에 대한 추이를 보여주세요.",
    "answer": "지난 3개월 동안 구입스크랩, 자가철스크랩, 합금철, 구입소재별로 총 중량은 각각  {{df[df['main_category']=='구입스크랩']['total_weight'].sum()}}kg,  {{df[df['main_category']=='자가철스크랩']['total_weight'].sum()}}kg,  {{df[df['main_category']=='합금철']['total_weight'].sum()}}kg,  {{df[df['main_category']=='구입소재']['total_weight'].sum()}}kg이며, 총 금액은 각각  {{df[df['main_category']=='구입스크랩']['total_amount'].sum()}}원,  {{df[df['main_category']=='자가철스크랩']['total_amount'].sum()}}원,  {{df[df['main_category']=='합금철']['total_amount'].sum()}}원,  {{df[df['main_category']=='구입소재']['total_amount'].sum()}}원입니다.",
    "stats": "year_month | category | total_weight | total_amount\n---------------------------------------------------\n2024-12 | 일반합금철 | 5074855.0 | 28800572510.0\n2024-12 | 특수합금강 | 175807.0 | 6278880124.0\n2025-01 | 일반합금철 | 4987976.0 | 29385525895.0\n2025-01 | 특수합금강 | 171892.0 | 6219752060.0\n2025-02 | 일반합금철 | 4934542.0 | 28360376553.0\n2025-02 | 특수합금강 | 173046.0 | 6457413877.0\n"
  },
  {
    "question": "구입 스크랩에 대해 STS스크랩, 일반스크랩, 특수합금강으로 구분하여 3개월의 추이를 보여주세요.",
    "answer": "구입 스크랩의 STS스크랩, 일반스크랩, 특수합금강의 최근 3개월 동안의 총 중량은 각각  {{df[df['sub_category']=='STS스크랩']['total_weight'].sum()}}kg,  {{df[df['sub_category']=='일반스크랩']['total_weight'].sum()}}kg,  {{df[df['sub_category']=='특수합금강']['total_weight'].sum()}}kg이며, 총 금액은 각각  {{df[df['sub_category']=='STS스크랩']['total_amount'].sum()}}원,  {{df[df['sub_category']=='일반스크랩']['total_amount'].sum()}}원,  {{df[df['sub_category']=='특수합금강']['total_amount'].sum()}}원입니다.",
    "stats": "year_month | total_weight | total_amount\n----------------------------------------\n2024-01 | 57299236.0 | 103358146984.0\n2024-02 | 56066886.0 | 102593267574.0\n2024-03 | 52335424.0 | 92793450326.0\n2024-04 | 56070470.0 | 92299469472.0\n2024-05 | 50425389.0 | 87808184180.0\n... (중간 생략) ...\n2024-10 | 41873075.0 | 68739581136.0\n2024-11 | 40550646.0 | 69745624948.0\n2024-12 | 36519851.0 | 67758170767.0\n2025-01 | 32059143.0 | 65564900879.0\n2025-02 | 34883472.0 | 63244996038.0\n"
  },
  {
    "question": "자가철 스크랩에 대해 STS, 탄합강, 공구강, 특수합금강으로 구분하여 3개월의 추이를 보여주세요.",
    "answer": "최근 3개월간 자가철 스크랩의 카테고리별 중량과 금액은 다음과 같습니다. STS의 총 중량은  {{df[df['category']=='STS']['total_weight'].sum()}}kg이며, 총 금액은  {{df[df['category']=='STS']['total_amount'].sum()}}원입니다. 탄합강의 총 중량은  {{df[df['category']=='탄합강']['total_weight'].sum()}}kg이며, 총 금액은  {{df[df['category']=='탄합강']['total_amount'].sum()}}원입니다. 공구강의 총 중량은  {{df[df['category']=='공구강']['total_weight'].sum()}}kg이며, 총 금액은  {{df[df['category']=='공구강']['total_amount'].sum()}}원입니다. 특수합금강의 총 중량은  {{df[df['category']=='특수합금강']['total_weight'].sum()}}kg이며, 총 금액은  {{df[df['category']=='특수합금강']['total_amount'].sum()}}원입니다.",
    "stats": "year | quarter | total_weight | total_amount\n--------------------------------------------\n2024 | Q1 | 2841397.0 | 87634166055.0\n2024 | Q2 | 2862203.0 | 88307518095.0\n2024 | Q3 | 2389994.0 | 73840586992.0\n2024 | Q4 | 1697464.0 | 54996275236.0\n"
  },
  {
    "question": "합금철에 대해 일반합금철, 특수합금강으로 구분하여 3개월의 추이를 보여주세요.",
    "answer": "지난 3개월 동안 합금철 중 일반합금철의 총 중량은  {{df[df['category'] == '일반합금철']['total_weight'].sum()}}kg이며, 총 금액은  {{df[df['category'] == '일반합금철']['total_amount'].sum()}}원입니다. 특수합금강의 총 중량은  {{df[df['category'] == '특수합금강']['total_weight'].sum()}}kg이며, 총 금액은  {{df[df['category'] == '특수합금강']['total_amount'].sum()}}원입니다. 이를 통해 합금철의 월별 추이를 확인할 수 있습니다.",
    "stats": "total_weight | total_amount\n---------------------------\n |40832675.0 | 99404999072.0 \n"
  },
  {
    "question": "구입소재에 대해 3개월의 추이를 보여주세요.",
    "answer": "최근 3개월 동안 '[세아] 구입소재'의 총 중량은  {{df['total_weight'].sum()}}kg이며, 총 금액은  {{df['total_amount'].sum()}}원입니다. 월별 구입소재 중량과 금액의 변동 추이는 다음과 같습니다.",
    "stats": "sap_category_l2 | weight_ratio\n------------------------------\n구입탄합강스크랩 | 42.72\n구입STS강스크랩 | 24.7\n사내STS강스크랩 | 15.72\n사내탄합강스크랩 | 5.97\n구입공구금형강스크랩 | 4.34\n사내특수합금강스크랩 | 4.33\n사내공구금형강스크랩 | 1.34\n구입특수합금강스크랩 | 0.89\n"
  },
  {
    "question": "스크랩 자재에 대한 월별 추이를 보여주세요.",
    "answer": "스크랩 자재의 월별 총 중량은  {{df['total_weight'].sum()}}kg이며, 총 금액은  {{df['total_amount'].sum()}}원입니다. 월별 자세한 데이터는 다음과 같습니다.",
    "stats": "year_month | material_detail | total_weight_ton | total_amount_million\n----------------------------------------------------------------------\n2024-01 | 316.자가발생철 | 3005.47 | 10154.12\n2024-01 | STS316 BRIQUET 구입 | 299.75 | 967.61\n2024-01 | STS316 구입 | 3111.55 | 11145.06\n2024-01 | 자가발생철 EP316LVV 강괴 | 258.55 | 2798.72\n2024-02 | 316.자가발생철 | 3163.41 | 10657.58\n... (중간 생략) ...\n2025-02 | DUPLEX 자가발생철_사내 DUPLEX | 1122.38 | 3154.74\n2025-02 | STS316 BRIQUET 구입_S316BQ | 29.07 | 92.9\n2025-02 | STS316 구입_S316_S316BD | 18.33 | 62.97\n2025-02 | 자가발생철 EP316LVV 강괴_사내 S316LVV 강괴 | 188.09 | 2044.36\n2025-02 | 자가발생철 EP316_사내 EP316 | 7.43 | 44.04\n"
  },
  {
    "question": "합금철 중 특수합금에 대한 24년 분기별 추이를 보여주세요.",
    "answer": "2024년에 합금철 중 특수합금의 분기별 총 중량은  {{df.groupby('분기')['total_weight'].sum()}}kg이며, 총 금액은  {{df.groupby('분기')['total_amount'].sum()}}원입니다. 분기별 총 중량과 금액을 분기별로 정렬한 표는 다음과 같습니다.",
    "stats": "year_month | total_weight | total_amount\n----------------------------------------\n2025-02 | 398033.0 | 14328015183.0\n"
  },
  {
    "question": "자재 중 우주항공용 자재에 대한 24년 5월 중량, 금액을 알려주세요.",
    "answer": "2024년 5월에 우주항공용 자재의 총 중량은  {{df['total_weight'].sum()}}kg이며, 총 금액은  {{df['total_amount'].sum()}}원입니다.",
    "stats": "sap_category_l2 | sap_category_l3 | total_weight | total_amount\n---------------------------------------------------------------\nAL | AL METAL | 115954.0 | 372917289.0\nAL | AL탈산제 | 99026.0 | 158954939.0\nB | FE-B | 10000.0 | 46053596.0\nCR | (H)FE-CR | 2030797.0 | 4525639949.0\nCR | (L)FE-CR | 123000.0 | 566726760.0\n... (중간 생략) ...\n특수합금철 | NI-NB | 0.0 | 0.0\n특수합금철 | NI-TA | 3654.0 | 1217015468.0\n특수합금철 | NI-ZR | 495.0 | 29915436.0\n특수합금철 | TI SPONGE | 19718.0 | 281472820.0\n특수합금철 | 전기동 | 26793.0 | 331051942.0\n"
  },
  {
    "question": "스크랩 중에서 구입 스크랩과 자가철 스크랩을 구분하여 전전월과 전월의 중량과 금액을 조회하세요. 월을 컬럼으로 배치하고 전월 대비 당월의 증감을 계산해 표시해 주세요.",
    "answer": "스크랩 카테고리별로 전전월과 전월의 중량과 금액을 조회한 결과, 구입 스크랩의 전월 중량은  {{df[df['category']=='구입스크랩']['total_weight_prev_month'].values[0]}}kg, 금액은  {{df[df['category']=='구입스크랩']['total_amount_prev_month'].values[0]}}원이며, 전전월 대비 중량은  {{df[df['category']=='구입스크랩']['weight_diff_mom'].values[0]}}kg, 금액은  {{df[df['category']=='구입스크랩']['amount_diff_mom'].values[0]}}원 증가하였습니다. 자가철 스크랩의 전월 중량은  {{df[df['category']=='자가철스크랩']['total_weight_prev_month'].values[0]}}kg, 금액은  {{df[df['category']=='자가철스크랩']['total_amount_prev_month'].values[0]}}원이며, 전전월 대비 중량은  {{df[df['category']=='자가철스크랩']['weight_diff_mom'].values[0]}}kg, 금액은  {{df[df['category']=='자가철스크랩']['amount_diff_mom'].values[0]}}원 증가하였습니다.",
    "stats": "year_month | total_weight | total_amount\n----------------------------------------\n2024-01 | 1182580.0 | 5826801043.0\n2024-02 | 1062580.0 | 5220091441.0\n2024-03 | 904580.0 | 4421257131.0\n2024-04 | 816580.0 | 3976336755.0\n2024-05 | 439580.0 | 2070257422.0\n2024-06 | 299580.0 | 1362429553.0\n"
  },
  {
    "question": "스크랩을 구입 스크랩과 자가철 스크랩으로 분류를 한 후 자재내역별로 24년 7월, 8월의 중량과 금액을 조회하세요. 월을 컬럼으로 표시하고 8월 기준으로 전월비를 계산해 표시하세요. 전월비 감소폭이 큰 순으로 자재내역을 나열해주세요.",
    "answer": "스크랩을 구입 스크랩과 자가철 스크랩으로 분류한 후, 2024년 7월과 8월의 각 자재별 중량과 금액을 조회하였습니다. 8월 기준으로 전월 대비 중량과 금액의 변동을 계산하여, 감소폭이 큰 순으로 자재를 나열하였습니다. 자세한 내용은 조회된 테이블을 참조해주세요.",
    "stats": "category | material_detail | total_weight_2024 | total_amount_2024\n------------------------------------------------------------------\n구입스크랩 | 생철 경량류 | 43456702.0 | 22007048545.0\n구입스크랩 | STS304 구입 | 40241229.0 | 75756266087.0\n구입스크랩 | 생철 중량류_생철A_생철L_생철O | 37837885.0 | 18252069213.0\n구입스크랩 | 생철 중량류 | 36558678.0 | 19018520994.0\n구입스크랩 | 중량류_중량A_중량AL_중량B_중량BL_중량O_중량ABL(Z) | 34340531.0 | 16126004469.0\n... (중간 생략) ...\n구입스크랩 | NIMONIC80A_NIMONIC80AG | 0.0 | 0.0\n자가철스크랩 | PERMALLOY.자가발생철_사내 PERMALLOY | 0.0 | 0.0\n자가철스크랩 | 자가발생철 ALLOY7001S2_사내 ALLOY7001S2 | 0.0 | 0.0\n자가철스크랩 | ALLOY20 자가발생철_사내 ALLOY20 | 0.0 | 0.0\n자가철스크랩 | ALLOY495 자가발생철_사내 ALLOY495 | 0.0 | 0.0"
  },
  {
    "question": "가장 최근의 스크랩의 자재량을 SAP 중분류별로 구분하여 비율로 알려주세요.",
    "answer": "가장 최근에 기록된 스크랩의 자재량은 SAP 중분류별로 다음과 같이 구분되며, 각각의 비율은 다음과 같습니다.",
    "stats": "sap_category_l1 | sap_category_l2 | total_weight\n------------------------------------------------\n구입소재 | 세아내탄합강압연품 | 44672.0\n구입소재 | 세아내탄합강제강품 | 11740.0\n구입소재 | 세아외탄합강압연품 | 277931.0\n구입소재 | 세아외탄합강제강품 | 276797.0\n구입소재 | 세아외특수합금강제강품 | 8418.0\n... (중간 생략) ...\n합금철 | V | 21559.0\n합금철 | W | 14417.0\n합금철 | WIRE | 129642.0\n합금철 | 우주항공용 | 661797.0\n합금철 | 특수합금철 | 214185.0\n"
  },
  {
    "question": "S316계의 월별 자재 추이를 자재내역별 표시해주세요. 중량과 금액 모두 표시가 필요하며 단위는 톤, 백만원으로 해주세요.",
    "answer": "S316계의 월별 자재 추이는 다음과 같습니다. 각 자재별 총 중량은  {{df['total_weight_ton'].sum()}}톤이며, 총 금액은  {{df['total_amount_million'].sum()}} 백만원입니다. 자세한 자재내역별 중량과 금액은 테이블을 참조해주세요.",
    "stats": "year_month | total_weight | total_amount\n----------------------------------------\n2024-01 | 66821743.62500007 | 198730921684.0\n2024-02 | 65638318.84100007 | 201341415877.0\n2024-03 | 61217054.21000006 | 188352026731.0\n2024-04 | 65363886.426000014 | 186278984252.0\n2024-05 | 60234815.856000006 | 178372542365.0\n... (중간 생략) ...\n2024-08 | 56863165.0 | 127366445725.0\n2024-09 | 41749326.0 | 102705836026.0\n2024-10 | 47798430.0 | 112053136462.0\n2024-11 | 47039674.0 | 113541707359.0\n2024-12 | 42391182.0 | 103819998264.0\n"
  },
  {
    "question": "400스크랩의 월별 자재 추이를 자재내역별 표시해주세요. 중량과 금액 모두 표시가 필요하며 단위는 톤, 백만원으로 해주세요.",
    "answer": "400스크랩의 월별 자재 추이는  {{df.groupby('year_month')['material_detail'].count()}}건이며, 총 중량은  {{df['total_weight_ton'].sum()}}톤, 총 금액은  {{df['total_amount_million'].sum()}}백만원입니다. 자재내역별로 보면,  {{df.groupby('material_detail')['total_weight_ton'].sum()}}톤,  {{df.groupby('material_detail')['total_amount_million'].sum()}}백만원입니다.",
    "stats": "material_code | total_weight_ton | total_amount_million\n-------------------------------------------------------\nBF000076 | 375.89 | 551.39\nBF000077 | 797.15 | 1954.73\nBF000078 | 659.55 | 1170.72\nBF000079 | 459.18 | 867.18\nBF000080 | 445.01 | 1055.91\n... (중간 생략) ...\nBF000145 | 4.18 | 219.99\nBF000146 | 1.48 | 89.2\nBF000147 | 0.0 | 0.0\nBF000148 | 0.0 | 0.0\nBF000150 | 0.0 | 0.0\n"
  },
  {
    "question": "특수합금 합금철의 최근 3개월 월별 중량, 금액을 보여주세요.",
    "answer": "특수합금 합금철의 최근 3개월 동안의 월별 중량과 금액은 다음과 같습니다. 총 중량은  {{df['total_weight'].sum()}}kg이며, 총 금액은  {{df['total_amount'].sum()}}원입니다.",
    "stats": "year_month | total_weight_ton | total_amount_billion\n----------------------------------------------------\n2025-02 | 173.05 | 64.57\n"
  },
  {
    "question": "24년 8월 전체 합금철 자재를 중분류와 소분류로 구분하여 중량, 금액을 표시해주세요.",
    "answer": "2024년 8월에는 각각의 중분류와 소분류에 따른 합금철 자재의 총 중량은  {{df['total_weight'].sum()}}kg이고, 총 금액은  {{df['total_amount'].sum()}}원입니다.",
    "stats": "sap_category_l2 | sap_category_l3 | total_weight | total_amount\n---------------------------------------------------------------\nAL | AL METAL | 115954.0 | 372917289.0\nAL | AL탈산제 | 99026.0 | 158954939.0\nB | FE-B | 10000.0 | 46053596.0\nCR | (H)FE-CR | 2030797.0 | 4525639949.0\nCR | (L)FE-CR | 123000.0 | 566726760.0\n... (중간 생략) ...\n특수합금철 | NI-NB | 0.0 | 0.0\n특수합금철 | NI-TA | 3654.0 | 1217015468.0\n특수합금철 | NI-ZR | 495.0 | 29915436.0\n특수합금철 | TI SPONGE | 19718.0 | 281472820.0\n특수합금철 | 전기동 | 26793.0 | 331051942.0\n"
  },
  {
    "question": "자재 중에서 Cathode Ni의 24년 월별 추이를 보여주세요.",
    "answer": "Cathode Ni 자재의 2024년 월별 총 중량은  {{df['total_weight'].sum()}}kg이며, 총 금액은  {{df['total_amount'].sum()}}원입니다. 월별 자세한 중량과 금액은 다음과 같습니다.",
    "stats": "sap_category_l2 | sap_category_l3 | total_weight | total_amount\n---------------------------------------------------------------\nAL | AL METAL | 115954.0 | 372917289.0\nAL | AL탈산제 | 99026.0 | 158954939.0\nB | FE-B | 10000.0 | 46053596.0\nCR | (H)FE-CR | 2030797.0 | 4525639949.0\nCR | (L)FE-CR | 123000.0 | 566726760.0\n... (중간 생략) ...\n특수합금철 | NI-NB | 0.0 | 0.0\n특수합금철 | NI-TA | 3654.0 | 1217015468.0\n특수합금철 | NI-ZR | 495.0 | 29915436.0\n특수합금철 | TI SPONGE | 19718.0 | 281472820.0\n특수합금철 | 전기동 | 26793.0 | 331051942.0\n"
  },
  {
    "question": "자재 중에서 Fe-Ni의 24년 월별 추이를 보여주세요.",
    "answer": "2024년도에 Fe-Ni 자재의 월별 총 중량은  {{df['total_weight']}}kg이며, 총 금액은  {{df['total_amount']}}원 입니다. 월별 자재 중량과 금액의 추이는 표와 같습니다.",
    "stats": "year_month | total_weight | total_amount\n----------------------------------------\n2024-01 | 1182580.0 | 5826801043.0\n2024-02 | 1062580.0 | 5220091441.0\n2024-03 | 904580.0 | 4421257131.0\n2024-04 | 816580.0 | 3976336755.0\n2024-05 | 439580.0 | 2070257422.0\n2024-06 | 299580.0 | 1362429553.0\n"
  },
  {
    "question": "24년 2분기의 자가철 스크랩 중량과 금액을 표시하고 특수합금만 따로 표시해주세요.",
    "answer": "2024년 2분기의 자가철 스크랩의 총 중량은  {{df['total_weight']}}kg이며, 총 금액은  {{df['total_amount']}}원입니다. 이 중 특수합금의 중량은  {{df['합계_중량_특수합금']}}kg이고, 금액은  {{df['합계_금액_특수합금']}}원입니다.",
    "stats": "total_weight | total_amount | special_alloy_weight | special_alloy_amount\n-------------------------------------------------------------------------\n145036319.0 | 473610948632.0 | 18673730.0 | 283064323143.0\n"
  },
  {
    "question": "24년 7, 8, 9월 자재를 평가클래스별로 나눠 중량, 금액을 보여주세요. 전체의 평균 값도 같이 표시해주세요.",
    "answer": "2024년 7, 8, 9월에 평가 클래스별로 나눈 자재의 총 중량은  {{df['total_weight'].sum()}}kg이고, 총 금액은  {{df['total_amount'].sum()}}원입니다. 평균 중량은  {{df['avg_weight'].mean()}}kg이며, 평균 금액은  {{df['avg_amount'].mean()}}원입니다.",
    "stats": "total_weight | total_amount | special_alloy_weight | special_alloy_amount\n-------------------------------------------------------------------------\n145036319.0 | 473610948632.0 | 18673730.0 | 283064323143.0\n"
  },
  {
    "question": "24년 7, 8, 9월 자재를 평가클래스별로 나눠 중량, 금액을 보여주세요. 각 월의 평균 값도 같이 표시해주세요.",
    "answer": "2024년 7, 8, 9월에 평가클래스별로 나눈 자재의 총 중량은  {{df['total_weight'].sum()}}kg이며, 총 금액은  {{df['total_amount'].sum()}}원입니다. 또한, 각 월별 평균 중량은  {{df['avg_weight'].mean()}}kg, 평균 금액은  {{df['avg_amount'].mean()}}원입니다.",
    "stats": "total_weight | total_amount | special_alloy_weight | special_alloy_amount\n-------------------------------------------------------------------------\n145036319.0 | 473610948632.0 | 18673730.0 | 283064323143.0\n"
  },
  {
    "question": "최근 3개월의 자재 중 사내 자가발생철 자재의 중량 추이를 조회하고, 각 월별로 중량이 가장 큰 항목을 표시해주세요.",
    "answer": "최근 3개월 동안 사내 자가발생철 자재의 총 중량은  {{df['total_weight'].sum()}}kg이며, 각 월별로 중량이 가장 큰 자재는  {{df.sort_values('total_weight', ascending=False).iloc[0]['max_material_detail']}}입니다.",
    "stats": "total_weight | total_amount | special_alloy_weight | special_alloy_amount\n-------------------------------------------------------------------------\n145036319.0 | 473610948632.0 | 18673730.0 | 283064323143.0\n"
  },
  {
    "question": "24년 7,8,9월의 자재 중 사내 자가발생철 자재의 중량을 자재내역 별로 조회하세요. 월을 컬럼으로 전환한 후 자재내역 별로 8월과 9월 기준으로 전월 대비 증감을 계산해 표시해주세요.",
    "answer": "24년 7,8,9월의 자재 중 사내 자가발생철 자재의 중량을 자재내역 별로 조회하였습니다. 8월과 9월에는 각각 전월 대비  {{df['weight_diff_2408'].sum()}}kg,  {{df['weight_diff_2409'].sum()}}kg 증가하였습니다. 자재내역 별로 상세한 중량과 월별 증감을 확인하실 수 있습니다.",
    "stats": "total_weight | total_amount | special_alloy_weight | special_alloy_amount\n-------------------------------------------------------------------------\n145036319.0 | 473610948632.0 | 18673730.0 | 283064323143.0\n"
  },
  {
    "question": "24년 7, 8, 9월 원부원료의 중량 추이를 조회하고, 각 월별로 중량이 가장 큰 자재 아이템을 표시해주세요.",
    "answer": "2024년 7월부터 9월까지 원부자재의 총 중량은  {{df['total_weight'].sum()}}kg이며, 각 월별로 중량이 가장 큰 자재 아이템은 다음과 같습니다.",
    "stats": "total_weight | total_amount | special_alloy_weight | special_alloy_amount\n-------------------------------------------------------------------------\n145036319.0 | 473610948632.0 | 18673730.0 | 283064323143.0\n"
  },
  {
    "question": "24년 7, 8, 9월의 원부원료 중량을 자재 아이템 별로 조회하세요. 월을 컬럼으로 전환한 후 아이템 별로 8월, 9월 기준 전월 대비 증감을 계산해 표시해주세요.",
    "answer": "2024년 7월, 8월, 9월 각 월별로 원부자재 아이템 별 총 중량을 조회한 결과를 통계 테이블로 제공하였습니다. 또한, 각 아이템 별로 8월과 9월의 월별 중량 증감을 계산하여 표시하였습니다. 자세한 내용은 조회된 통계 테이블을 참조해 주세요.",
    "stats": "total_weight | total_amount | special_alloy_weight | special_alloy_amount\n-------------------------------------------------------------------------\n145036319.0 | 473610948632.0 | 18673730.0 | 283064323143.0\n"
  },
  {
    "question": "24년 7, 8, 9월의 원부원료 중량을 자재 아이템 별로 조회하세요. 월을 컬럼으로 전환해 아이템 별로 8월, 9월 기준으로 전월 대비 증감을 계산하세요. 8월과 9월 각각에 대해 상승폭이 가장 큰 자재 아이템을 표시해주세요.",
    "answer": "2024년 8월에 전월 대비 중량 증가가 가장 큰 자재 아이템은  {{df[df['year_month'] == '2024-08'].sort_values('weight_diff_mom', ascending=False).iloc[0]['material_detail']}}이며, 증가량은  {{df[df['year_month'] == '2024-08'].sort_values('weight_diff_mom', ascending=False).iloc[0]['weight_diff_mom']}}kg입니다. 2024년 9월에 전월 대비 중량 증가가 가장 큰 자재 아이템은  {{df[df['year_month'] == '2024-09'].sort_values('weight_diff_mom', ascending=False).iloc[0]['material_detail']}}이며, 증가량은  {{df[df['year_month'] == '2024-09'].sort_values('weight_diff_mom', ascending=False).iloc[0]['weight_diff_mom']}}kg입니다.",
    "stats": "total_weight | total_amount | special_alloy_weight | special_alloy_amount\n-------------------------------------------------------------------------\n145036319.0 | 473610948632.0 | 18673730.0 | 283064323143.0\n"
  },
  {
    "question": "24년 7월의 자재를 대상으로 SAP 대분류 별로 중량을 계산하고 그 중량을 다시 중분류로 나눠 표시해주세요.",
    "answer": "2024년 7월의 자재를 대상으로, 각 SAP 대분류별 총 중량은  {{df.groupby('SAP대분류명')['total_weight'].sum()}}kg이며, 이를 다시 중분류별로 나누면  {{df.groupby(['SAP대분류명', 'sap_category_l2'])['total_weight'].sum()}}kg 입니다.",
    "stats": "sap_category_l1 | sap_category_l2 | total_weight\n------------------------------------------------\n |  | 0.0\n공기구 | 가열공구 | 96.0\n공기구 | 건설/파쇄공구 | 38.0\n공기구 | 고정공구 | 15.0\n공기구 | 공구부속/보조용품 | 6624.0\n... (중간 생략) ...\n합금철 | 특수합금철 | 2658809.0\n화공품 | 도료재 | 63.0\n화공품 | 시험약품 | 1162619.0\n화공품 | 실험기자재 | 226.0\n화공품 | 화공약품 | 352165.0\n"
  },
  {
    "question": "24년 전체 자재의 월별 추이를 표시해주세요.",
    "answer": "2024년 동안 월별 자재의 총 중량은  {{df['total_weight'].sum()}}kg이고, 총 금액은  {{df['total_amount'].sum()}}원입니다. 월별 자재 사용 추이는 표를 참조하세요.",
    "stats": "year_month | total_weight | total_amount\n----------------------------------------\n2024-01 | 66821743.62500007 | 198730921684.0\n2024-02 | 65638318.84100007 | 201341415877.0\n2024-03 | 61217054.21000006 | 188352026731.0\n2024-04 | 65363886.426000014 | 186278984252.0\n2024-05 | 60234815.856000006 | 178372542365.0\n... (중간 생략) ...\n2024-08 | 56863165.0 | 127366445725.0\n2024-09 | 41749326.0 | 102705836026.0\n2024-10 | 47798430.0 | 112053136462.0\n2024-11 | 47039674.0 | 113541707359.0\n2024-12 | 42391182.0 | 103819998264.0\n"
  },
  {
    "question": "24년 3분기의 합금철을 자재 코드별로 구분하여 보여주세요. 중량과 금액 모두 표시가 필요하며 단위는 각각 톤과 백만원입니다.",
    "answer": "2024년 3분기에 사용된 합금철의 자재 코드별 총 중량은  {{df['total_weight_ton'].sum()}}톤이며, 총 금액은  {{df['total_amount_million'].sum()}} 백만원입니다. 자재 코드별로 구분한 중량과 금액은 테이블로 확인하실 수 있습니다.",
    "stats": "material_code | total_weight_ton | total_amount_million\n-------------------------------------------------------\nBF000076 | 1342.69 | 1835.92\nBF000077 | 2927.7 | 7100.6\nBF000078 | 2394.41 | 4200.2\nBF000079 | 2916.45 | 5286.96\nBF000080 | 2047.69 | 4922.84\n... (중간 생략) ...\nBF000145 | 16.7 | 878.08\nBF000146 | 5.18 | 311.49\nBF000147 | 0.0 | 0.0\nBF000148 | 0.0 | 0.0\nBF000150 | 0.0 | 0.0\n"
  },
  {
    "question": "최근 3개월의 특수합금 합금철에 대해 자재의 중량과 금액을 표시해 주세요. 톤과 억원 단위로 표시해주세요.",
    "answer": "최근 3개월 동안 특수합금 합금철의 총 중량은  {{df['total_weight_ton'].sum()}}톤이며, 총 금액은  {{df['total_amount_billion'].sum()}}억원입니다.",
    "stats": "material_code | total_weight_ton | total_amount_million\n-------------------------------------------------------\nBF000076 | 1342.69 | 1835.92\nBF000077 | 2927.7 | 7100.6\nBF000078 | 2394.41 | 4200.2\nBF000079 | 2916.45 | 5286.96\nBF000080 | 2047.69 | 4922.84\n... (중간 생략) ...\nBF000145 | 16.7 | 878.08\nBF000146 | 5.18 | 311.49\nBF000147 | 0.0 | 0.0\nBF000148 | 0.0 | 0.0\nBF000150 | 0.0 | 0.0\n"
  },
  {
    "question": "24년 9월 전체 자재 중에서 니켈 합금철에 대해 전체 중량과 금액을 천톤, 억원 단위로 나타내고 항목별로 중량 기준 내림차순으로 보여주세요.",
    "answer": "2024년 9월에 니켈 합금철의 전체 중량은  {{df['total_weight_thousand_ton'].sum()}} 천톤이며, 총 금액은  {{df['total_amount_billion'].sum()}} 억원입니다. 자재별로 보면, 중량이 가장 많은 자재는  {{df.sort_values('total_weight_ton_by_material', ascending=False).iloc[0]['material_detail']}}이며, 그 중량은  {{df.sort_values('total_weight_ton_by_material', ascending=False).iloc[0]['total_weight_ton_by_material']}}톤입니다.",
    "stats": "material_detail | total_weight_ton | total_amount_billion\n---------------------------------------------------------\nFe-Ni(35%) 페로니켈35% | 4210.0 | 212.85\nFE-NI(35%) 페로니켈30%_NI(35%이상)_CO(1.20%이하) | 2840.4 | 146.7\nMe-Ni(99%) 메탈니켈 | 2719.0 | 654.89\nNPI (NICKEL PIG IRON)_NI(10%이상) | 1361.84 | 30.2\nME-NI(99%) 메탈니켈_NI(98%이상)_C(0.05%이하)_CO( | 1180.47 | 281.07\n... (중간 생략) ...\nU-Ni(97.5%) 유니켈 | 232.83 | 58.04\nU-NI(97.5%) 유니켈_NI(96%이상)_CO(1.60%이하)_C( | 220.33 | 49.0\nFe-Ni(20%) 페로니켈20% | 0.01 | 0.0\nFE-NI(20%) 페로니켈20%_NI(16%이상)_C(3%이하)_CO( | 0.01 | 0.0\nFE-NI(18%) 페로니켈 소립_NI(14%이상)_CO(0.80%이하) | 0.0 | 0.0\n"
  },
  {
  "question": "25년 1월 재공 재고 총 중량은 얼마인가요?",
  "answer": "2025년 1월 기준 재공 재고의 총 중량은 {{df['total_weight'].sum()}}kg입니다.",
  "stats": "total_weight\n------------------\n1167751531.062"
  }
]